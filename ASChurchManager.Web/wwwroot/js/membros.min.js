function PesquisarCongregacao(n){if(n>0){var t={CongregacaoId:n};$.ajaxPost("/Secretaria/Congregacao/BuscarCongregacao",t,function(n){$("#CongregacaoNome").val("");n.Id==0?($.bsMessageError("Atenção","Código inválido!"),$(this).val("")):n.Id>0&&$("#CongregacaoNome").val(n.Nome)})}}function ValidarFormEnvioBatismo(){var n="";return $("span[id*=-error]").each(function(t,i){$(i).text()!=""&&(n+=$(i).text()+"<br>")}),n}function ValidarFormulario(){var n="";return $(".tab-pane").find("span[id*=-error]").each(function(t,i){$(i).text()!=""&&(n+=$(i).text()+"<br>")}),n}function formatJsonToDate(n){var t=n.substring(0,10).split("-");return t[2]+"/"+t[1]+"/"+t[0]}function formatJsonToTime(n){var t=new Date(parseInt(n.substr(6))).toUTCString();return t.substring(17,22)}function GerarCarteirinha(n,t){var i={Id:n};$.ajaxPost("/Secretaria/Membro/VerificaVencimentoCarteirinha",i,function(i){if(i.DataValidade!=""&&i.DataValidade!=null)$.showYesNoAlert("A Carteirinha do Membro vence em "+i.DataValidade+". Deseja gerar um novo vencimento para ela?","Carteirinha Membro",function(){var i="/Secretaria/Membro/CarteirinhaMembros?id="+n.toString()+"&atualizaValidade=true";$.downloadArquivo(i,t)},null,function(){var i="/Secretaria/Membro/CarteirinhaMembros?id="+n.toString()+"&atualizaValidade=false";$.downloadArquivo(i,t)},null);else{var r="/Secretaria/Membro/CarteirinhaMembros?id="+n.toString()+"&atualizaValidade=false";$.downloadArquivo(r,t)}})}function buscarMembro(n,t){if(n>0){var i={MembroId:n};t="#"+t;$.ajaxPost("/Secretaria/Membro/BuscarMembro",i,function(n){$(t).val("");n.Id==0?($.bsMessageError("Atenção","Membro não cadastrado!"),$(this).val("")):n.Id>0&&$(t).val(n.Nome)})}}function ExcluirRowSit(n){$.showYesNoAlert("Deseja excluir a Situação?","Excluir Situação",function(){var i=n.parentNode.parentNode.sectionRowIndex,r=document.getElementById("tbSit").getElementsByTagName("tbody")[0],t;r.deleteRow(i);sit.splice(i,1);sit.length==0&&(t=r.insertRow(0),t.className="jtable-data-row",IncluirCelulasTabela(t,0,"100%","Não há situação cadastrada para o Membro",permiteexcluirsituacaomembro?4:3))})}function AtualizarRowSit(n){var t=n.parentNode.parentNode.sectionRowIndex;indexSit=t;$("#IdSit").val(sit[t].IdSit);$("#DataSit").val(sit[t].DataSit);$("#ObservacaoSit").val(sit[t].ObservacaoSit);$("#btnAddSit").val("Atualizar");$("#IdSit").focus();HabilitarBotoesTabela($(document.getElementById("tbSit").getElementsByTagName("tbody")),!0)}function CarregarDadosSituacao(n,t,i,r,u){return{IdSit:n,DescricaoSit:t,DataSit:i,ObservacaoSit:r,MostrarBotao:u}}function MontarGridSituacao(n){var r=document.getElementById("tbSit").getElementsByTagName("tbody")[0],t,i,u;for($(r).empty(),t=0;t<n.length;t++)i=r.insertRow(t),i.className="jtable-data-row"+(t%2==0?" jtable-row-even":""),IncluirCelulasTabela(i,0,null,n[t].DescricaoSit),IncluirCelulasTabela(i,1,null,n[t].DataSit),IncluirCelulasTabela(i,2,null,n[t].ObservacaoSit),(n[t].MostrarBotao||permiteexcluirsituacaomembro&&!isreadonly)&&(u=' <button type="button" class="btn btn-info btn-sm" onclick="AtualizarRowSit(this);"><span class="glyphicon glyphicon-refresh"><\/span> Atualizar<\/button> <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowSit(this);"><span class="glyphicon glyphicon-trash"><\/span> Excluir<\/button>',IncluirCelulasTabela(i,3,null,u))}function ExcluirRowCargos(n){$.showYesNoAlert("Deseja excluir o Cargo?","Excluir Cargo",function(){var i=n.parentNode.parentNode.sectionRowIndex,r=document.getElementById("tbCargos").getElementsByTagName("tbody")[0],t;r.deleteRow(i);cargos.splice(i,1);cargos.length==0&&(t=r.insertRow(0),t.className="jtable-data-row",IncluirCelulasTabela(t,0,"100%","Não há cargos cadastrados para o Membro",permiteexcluircargomembro?6:5))})}function AtualizarRowCargos(n){var t=n.parentNode.parentNode.sectionRowIndex;indexCargo=t;$("#CargoId").val(cargos[t].CargoId);$("#CargoId").blur();$("#DataCargo").val(cargos[t].DataCargo);$("#LocalConsagracao").val(cargos[t].LocalConsagracao);$("#Confradesp").val(cargos[t].Confradesp);$("#CGADB").val(cargos[t].CGADB);$("#btnAddCargo").val("Atualizar");$("#CargoId").focus();HabilitarBotoesTabela($(document.getElementById("tbCargos").getElementsByTagName("tbody")),!0)}function CarregarDadosCargos(n,t,i,r,u,f,e){return{CargoId:n,DescricaoCargo:t,LocalConsagracao:i,DataCargo:r,Confradesp:u,CGADB:f,MostrarBotao:e}}function MontarGridCargos(n){var r=document.getElementById("tbCargos").getElementsByTagName("tbody")[0],t,i,u;for($(r).empty(),t=0;t<n.length;t++)i=r.insertRow(t),i.className="jtable-data-row"+(t%2==0?" jtable-row-even":""),IncluirCelulasTabela(i,0,null,n[t].DescricaoCargo),IncluirCelulasTabela(i,1,null,n[t].LocalConsagracao),IncluirCelulasTabela(i,2,null,n[t].DataCargo),IncluirCelulasTabela(i,3,null,n[t].Confradesp),IncluirCelulasTabela(i,4,null,n[t].CGADB),(n[t].MostrarBotao||permiteexcluircargomembro&&!isreadonly)&&(u=' <button type="button" class="btn btn-info btn-sm" onclick="AtualizarRowCargos(this);"><span class="glyphicon glyphicon-refresh"><\/span> Atualizar<\/button> <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowCargos(this);"><span class="glyphicon glyphicon-trash"><\/span> Excluir<\/button>',IncluirCelulasTabela(i,5,null,u))}function ExcluirRowObs(n){$.showYesNoAlert("Deseja excluir a Observação?","Excluir Observação",function(){var i=n.parentNode.parentNode.sectionRowIndex,r=document.getElementById("tbObs").getElementsByTagName("tbody")[0],t;r.deleteRow(i);obs.splice(i,1);obs.length==0&&(t=r.insertRow(0),t.className="jtable-data-row",IncluirCelulasTabela(t,0,"100%","Não há observações cadastradas para o Membro",4))})}function AtualizarRowObs(n){var t=n.parentNode.parentNode.sectionRowIndex;indexObs=t;$("#Observacao").val(obs[t].Observacao);$("#DataCadastroObs").val(obs[t].DataCadastroObs);$("#btnAddObs").val("Atualizar");$("#Observacao").focus();HabilitarBotoesTabela($(document.getElementById("tbObs").getElementsByTagName("tbody")),!0)}function CarregarDadosObservacao(n,t,i,r,u){return{Observacao:n,DataCadastroObs:t,ResponsavelObs:i,IdResponsavelObs:r,MostrarBotao:u}}function MontarGridObs(n){var r=document.getElementById("tbObs").getElementsByTagName("tbody")[0],t,i,u;for($(r).empty(),t=0;t<n.length;t++)i=r.insertRow(t),i.className="jtable-data-row"+(t%2==0?" jtable-row-even":""),IncluirCelulasTabela(i,0,null,n[t].Observacao),IncluirCelulasTabela(i,1,null,n[t].DataCadastroObs),IncluirCelulasTabela(i,2,null,n[t].ResponsavelObs),(n[t].MostrarBotao||permiteexcluirobservacaomembro&&!isreadonly)&&(u=' <button type="button" class="btn btn-info btn-sm" onclick="AtualizarRowObs(this);"><span class="glyphicon glyphicon-refresh"><\/span> Atualizar<\/button> <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowObs(this);"><span class="glyphicon glyphicon-trash"><\/span> Excluir<\/button>',IncluirCelulasTabela(i,3,null,u))}function IncluirCelulasTabela(n,t,i,r,u){var f=n.insertCell(t);i!=null&&i!=undefined&&i!=""&&(f.width=i);u!=null&&u!=undefined&&u!=""&&(f.colSpan=u);f.innerHTML=r}function HabilitarBotoesTabela(n,t){$(n).find("tr").each(function(n,i){var r=$(i);$(r).find(".btn").each(function(n,i){$(i).prop("disabled",t)})})}function bytesToSize(n){var t;return n==0?"0 Byte":(t=parseInt(Math.floor(Math.log(n)/Math.log(1024))),Math.round(n/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t])}function DownloadRowArq(n,t){Download(t)}function ExcluirRowArq(n,t){$.showYesNoAlert("Deseja excluir o Arquivo?","Excluir Arquivo",function(){ExcluirArquivo(t);MontarGridArquivo()})}function MontarGridArquivo(){var t=EncontrarItem(arquivos,function(n){return n.IsCurso==!1&&n.IsDelete==!1}),f=$("#IsReadOnly").val().toLowerCase()=="true",r,n,i,u;if(t==undefined||t.length==0)r=document.getElementById("tbArq").getElementsByTagName("tbody")[0],$(r).empty(),i=r.insertRow(0),i.className="jtable-data-row",IncluirCelulasTabela(i,0,"100%","Não há Documentos cadastrados para o Membro",4);else for(r=document.getElementById("tbArq").getElementsByTagName("tbody")[0],$(r).empty(),n=0;n<t.length;n++)i=r.insertRow(n),i.className="jtable-data-row"+(n%2==0?" jtable-row-even":""),IncluirCelulasTabela(i,0,null,t[n].DescricaoArquivo),IncluirCelulasTabela(i,1,null,t[n].NomeOriginal),IncluirCelulasTabela(i,2,null,bytesToSize(t[n].Tamanho)),u="",f||(u+=t[n].IsSave?' <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowArq(this,{0});"><span class="glyphicon glyphicon-trash"><\/span> Excluir<\/button>'.format(t[n].Id):' <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowArq(this,{0});"><span class="glyphicon glyphicon-trash"><\/span> Excluir<\/button>'.format(t[n].Index)),t[n].IsSave&&t[n].NomeOriginal!=null&&t[n].NomeOriginal!=undefined&&t[n].NomeOriginal!=""&&(u+=' <button type="button" class="btn btn-info btn-sm" onclick="DownloadRowArq(this,{0});"><span class="glyphicon glyphicon-download-alt"><\/span> Download<\/button>'.format(t[n].Id)),IncluirCelulasTabela(i,3,null,u)}function HabilitarCamposCurso(n){n?($("#CursoId").removeAttr("disabled"),$("#Local").attr("disabled","disabled"),$("#NomeCurso").attr("disabled","disabled"),$("#DataInicioCurso").attr("disabled","disabled"),$("#DataEncerramentoCurso").attr("disabled","disabled"),$("#CargaHoraria").attr("disabled","disabled"),$("#ArquivoCurso").removeAttr("disabled")):($("#CursoId").attr("disabled","disabled"),$("#Local").removeAttr("disabled"),$("#NomeCurso").removeAttr("disabled"),$("#DataInicioCurso").removeAttr("disabled"),$("#DataEncerramentoCurso").removeAttr("disabled"),$("#CargaHoraria").removeAttr("disabled"),$("#ArquivoCurso").removeAttr("disabled"))}function CarregarDadosCurso(n){if(LimparCamposCurso(),n!=null&&n!=undefined&&n!=""&&parseInt(n)!=0){var t=EncontrarItem(dadosCursos,function(t){return t.Id==n});t.length>0?($("#Local").val("Sede"),$("#NomeCurso").val(t[0].Descricao),$("#DataInicioCurso").val(formatJsonToDate(t[0].DataInicio)),$("#DataEncerramentoCurso").val(formatJsonToDate(t[0].DataEncerramento)),$("#CargaHoraria").val(t[0].CargaHoraria)):$.alertError("Membro","Não foi encontrado os dados para o Curso")}}function LimparCamposCurso(n){n&&($(document).find("[data-valmsg-for='Cadastrado']").html(""),$(document).find("[data-valmsg-for='CursoId']").html(""));$(document).find("[data-valmsg-for='Local']").html("");$(document).find("[data-valmsg-for='NomeCurso']").html("");$(document).find("[data-valmsg-for='DataInicioCurso']").html("");$(document).find("[data-valmsg-for='DataEncerramentoCurso']").html("");$(document).find("[data-valmsg-for='CargaHoraria']").html("");$(document).find("[data-valmsg-for='ArquivoCurso']").html("");n&&($("#Cadastrado").val("0"),HabilitarCamposCurso(!1),$("#CursoId").val(""));$("#Local").val("");$("#NomeCurso").val("");$("#DataInicioCurso").val("");$("#DataEncerramentoCurso").val("");$("#CargaHoraria").val("");$("#ArquivoCurso").val("")}function CarregarCurso(n,t,i,r,u,f,e,o){return{CursoId:n,Local:t,NomeCurso:i,DataInicioCurso:r,DataEncerramentoCurso:u,CargaHoraria:f,ArquivoCurso:e,Id:o}}function MontarGridCursos(){var t=EncontrarItem(arquivos,function(n){return n.IsCurso&&n.IsDelete==!1}),u=document.getElementById("tbCursos").getElementsByTagName("tbody")[0],f,n,i,r;if($(u).empty(),f=$("#IsReadOnly").val().toLowerCase()=="true",t==undefined||t.length==0)i=u.insertRow(0),i.className="jtable-data-row",IncluirCelulasTabela(i,0,"100%","Não há Cursos cadastrados para o Membro",6);else for(n=0;n<t.length;n++)i=u.insertRow(n),i.className="jtable-data-row"+(n%2==0?" jtable-row-even":""),IncluirCelulasTabela(i,0,null,t[n].NomeCurso),IncluirCelulasTabela(i,1,null,t[n].Local),IncluirCelulasTabela(i,2,null,t[n].DataInicioCurso),IncluirCelulasTabela(i,3,null,t[n].DataEncerramentoCurso),IncluirCelulasTabela(i,4,null,t[n].CargaHoraria),r="",f||(r+=t[n].IsSave?' <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowCurso(this,{0});"><span class="glyphicon glyphicon-trash"><\/span> Excluir<\/button>'.format(t[n].Id):' <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowCurso(this,{0});"><span class="glyphicon glyphicon-trash"><\/span> Excluir<\/button>'.format(t[n].Index)),t[n].IsSave&&t[n].NomeOriginal!=null&&t[n].NomeOriginal!=undefined&&t[n].NomeOriginal!=""&&(r+=' <button type="button" class="btn btn-info btn-sm" onclick="DownloadRowCurso(this,{0});"><span class="glyphicon glyphicon-download-alt"><\/span> Download<\/button>'.format(t[n].Id)),IncluirCelulasTabela(i,5,null,r)}function CarregarDadosArquivo(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){return{IsCurso:n,Cadastrado:t,Id:i,MembroId:r,CursoId:u,NomeCurso:f,Local:e,DataInicioCurso:o,DataEncerramentoCurso:s,CargaHoraria:h,Arquivo:c,ArquivoCurso:l,DescricaoArquivo:a,NomeOriginal:v,Tamanho:y,IsDelete:p,IsSave:w,Index:b,IsDone:k}}function AddRowGridModal(n,t){var r=$("#modalSalvar table")[0].getElementsByTagName("tbody")[0],i=r.insertRow(r.rows.length),u,f;i.setAttribute("name","row{0}".format(n));u=i.insertCell(0);f=i.insertCell(1);u.innerHTML='<span id="lbl{0}">{1}<\/span>'.format(n,t);f.innerHTML='<div id="div{0}"><div class="as-reload-img"><div><\/div>'.format(n)}function ExcluirRowCurso(n,t){$.showYesNoAlert("Deseja excluir o Curso?","Excluir Curso",function(){ExcluirArquivo(t);MontarGridCursos()})}function ExcluirArquivo(n){var t=EncontrarIndice(arquivos,function(t){return t.Index==n});t>-1&&(arquivos[t].IsDelete=!0)}function DownloadRowCurso(n,t){Download(t)}function Download(n,t){var i="/Secretaria/Membro/DownloadArquivo?id={0}".format(n);$.downloadArquivo(i,t)}function gera_id(){for(var t=Math.ceil(Math.random()*Math.pow(10,7)),n=Math.ceil(Math.log(t)),i;n>10;)n=Math.ceil(Math.log(n));return i="{0}{1}".format(t,n),parseInt(i)}function HabilitarBotaoModal(n){return count=n.reduce(function(n,t){return n+ +t.IsDone},0),n.length==count}function ExistsFileToSave(){for(var n=0;n<arquivos.length;n++)if(arquivos[n].IsDelete&&arquivos[n].IsSave||!arquivos[n].IsDelete&&!arquivos[n].IsSave)return!0;return!1}function showImagePreview(n){$(dom.uploads).html("");$(dom.fileDescription).html("");var t=$(new Image).appendTo(dom.uploads),i=new mOxie.Image;i.onload=function(){i.downsize(180,230);t.prop("src",i.getAsDataURL());t.prop("id","imgFoto");t.prop("class","arquivoFoto");t.prop("alt","Foto")};i.load(n.getSource());setTimeout(function(){var n=$(".arquivoFoto").attr("src");if(n==undefined){removerFoto();i.destroy();t.prop("id","imgFoto");t.prop("class","arquivoFoto");t.prop("alt","Foto");t.prop("src","");$.bsMessageWarning("Atenção","Formato de arquivo inválido!");return}},300);$(dom.fileDescription).append('<div id="'+n.id+'">'+n.name+" ("+plupload.formatSize(n.size)+") <b><\/b><\/div>")}function removerBordaFoto(){$("#imgFoto").attr("src")!=undefined&&$("#imgFoto").attr("src")!=""&&($(dom.fotoBorder).css("border","0px"),$(dom.removeFile).css("display","block"))}function removerFoto(){$("#imgFoto").attr("src","");$("#imgFoto").attr("alt","Foto");$(dom.hdnFoto).val("");$(dom.fotoBorder).css("border","1px solid black")}var dadosCargos=[],dadosCursos=[],indexObs=-1,indexCargo=-1,indexSit=-1,files,fileCurso,isreadonly=!1,urlFechar="",arquivos=[],permiteexcluircargomembro=!1,permiteexcluirobservacaomembro=!1,permiteexcluirsituacaomembro=!1,dom;$(function(){var t=$("#Acao").val(),n,i;if(isreadonly=$("#Pessoa_somenteleitura").val().toLowerCase()=="true",(cargos==null||cargos==undefined)&&(cargos=[]),(obs==null||obs==undefined)&&(obs=[]),(sit==null||sit==undefined)&&(sit=[]),t==="Create"||t==="Read"||t==="Update"||t==="Delete"){if(permiteexcluircargomembro=$("#PermiteExcluirCargoMembro").val().toLowerCase()=="true",permiteexcluirobservacaomembro=$("#PermiteExcluirObservacaoMembro").val().toLowerCase()=="true",permiteexcluirsituacaomembro=$("#PermiteExcluirSituacaoMembro").val().toLowerCase()=="true",sit&&sit.length>0&&MontarGridSituacao(sit),cargos&&cargos.length>0&&MontarGridCargos(cargos),obs&&obs.length>0&&MontarGridObs(obs),arquivosMembros&&arquivosMembros.length>0){for(n=0;n<arquivosMembros.length;n++)arquivos.push(CarregarDadosArquivo(arquivosMembros[n].IsCurso,arquivosMembros[n].Cadastrado,arquivosMembros[n].Id,arquivosMembros[n].MembroId,arquivosMembros[n].IsCurso?arquivosMembros[n].CursoId:0,arquivosMembros[n].IsCurso?arquivosMembros[n].NomeCurso:"",arquivosMembros[n].IsCurso?arquivosMembros[n].Local:"",arquivosMembros[n].IsCurso?formatJsonToDate(arquivosMembros[n].DataInicioCurso):"",arquivosMembros[n].IsCurso?formatJsonToDate(arquivosMembros[n].DataEncerramentoCurso):"",arquivosMembros[n].IsCurso?arquivosMembros[n].CargaHoraria:"",null,null,arquivosMembros[n].IsCurso?"":arquivosMembros[n].DescricaoArquivo,arquivosMembros[n].NomeOriginal,arquivosMembros[n].Tamanho,!1,arquivosMembros[n].IsSave,arquivosMembros[n].Index));MontarGridArquivo();MontarGridCursos()}$(document).on("click","#btnCancSit",{},function(n){n.preventDefault();$("#IdSit").val("");$("#DataSit").val("");$("#ObservacaoSit").val("");indexSit=-1;$("#btnAddSit").val("Adicionar");permiteexcluirsituacaomembro&&!isreadonly&&HabilitarBotoesTabela($(document.getElementById("tbSit").getElementsByTagName("tbody")),!1)});$(document).on("click","#btnAddSit",{},function(n){var t,f,u,i,r;if(n.preventDefault(),t=CarregarDadosSituacao($("#IdSit").val(),$("#IdSit :selected").text(),$("#DataSit").val(),$("#ObservacaoSit").val(),!0),f=$(document).find("[data-valmsg-for='IdSit']"),f.html(""),u=$(document).find("[data-valmsg-for='DataSit']"),u.html(""),i=!1,(t.IdSit==null||t.IdSit==undefined||t.IdSit==0)&&(i=!0,f.html('<span id="IdSit-error" class="">O campo Situação é obrigatório<\/span>')),(t.DataSit==null||t.DataSit==undefined||t.DataSit==0)&&(i=!0,u.html('<span id="DataSit-error" class="">O campo Data é obrigatório<\/span>')),t.DataSit!=null&&t.DataSit!=undefined&&t.DataSit!=""&&(r=new Date,r.setYear(t.DataSit.split("/")[2]),r.setMonth(t.DataSit.split("/")[1]-1),r.setDate(t.DataSit.split("/")[0]),r.getTime()>(new Date).getTime()&&(u.html('<span id="DataSit-error" class="">A Data da Situação deve ser menor que a Data Atual<\/span>'),i=!0)),i)return!1;indexSit>-1&&(sit.splice(indexSit,1),indexSit=-1);sit.push(t);sit.sort(function(n,t){var i=n.DataSit.split("/"),u=new Date(i[2],i[1]-1,i[0]),r;return i=t.DataSit.split("/"),r=new Date(i[2],i[1]-1,i[0]),u<r?1:u>r?-1:0});MontarGridSituacao(sit);$("#btnAddSit").val("Adicionar");$("#IdSit").val("");$("#DataSit").val("");$("#ObservacaoSit").val("");permiteexcluirsituacaomembro&&!isreadonly&&HabilitarBotoesTabela($(document.getElementById("tbSit").getElementsByTagName("tbody")),!1)});$("#Confradesp").prop("disabled",!0);$("#CGADB").prop("disabled",!0);$.ajaxPost("/Secretaria/Membro/DadosCargos",null,function(n){dadosCargos=n});$(document).on("click","#btnCancCargo",{},function(n){n.preventDefault();$("#CargoId").val("");$("#DataCargo").val("");$("#LocalConsagracao").val("");$("#Confradesp").val("");$("#CGADB").val("");$("#Confradesp").prop("disabled",!0);$("#CGADB").prop("disabled",!0);indexCargo=-1;$("#btnAddCargo").val("Adicionar");permiteexcluircargomembro&&!isreadonly&&HabilitarBotoesTabela($(document.getElementById("tbCargos").getElementsByTagName("tbody")),!1)});$(document).on("click","#btnAddCargo",{},function(n){var t,f,u,i,r;if(n.preventDefault(),t=CarregarDadosCargos($("#CargoId").val(),$("#CargoId :selected").text(),$("#LocalConsagracao").val(),$("#DataCargo").val(),$("#Confradesp").val(),$("#CGADB").val(),!0),f=$(document).find("[data-valmsg-for='CargoId']"),f.html(""),u=$(document).find("[data-valmsg-for='DataCargo']"),u.html(""),i=!1,(t.CargoId==null||t.CargoId==undefined||t.CargoId==0)&&(i=!0,f.html('<span id="CargoId-error" class="">O campo Cargo é obrigatório<\/span>')),(t.DataCargo==null||t.DataCargo==undefined||t.DataCargo==0)&&(i=!0,u.html('<span id="DataCargo-error" class="">O campo Data do Cargo é obrigatório<\/span>')),t.DataCargo!=null&&t.DataCargo!=undefined&&t.DataCargo!=""&&(r=new Date,r.setYear(t.DataCargo.split("/")[2]),r.setMonth(t.DataCargo.split("/")[1]-1),r.setDate(t.DataCargo.split("/")[0]),r.getTime()>(new Date).getTime()&&(u.html('<span id="DataCargo-error" class="">A Data do Cargo deve ser menor que a Data Atual<\/span>'),i=!0)),i)return!1;indexCargo>-1&&(cargos.splice(indexCargo,1),indexCargo=-1);cargos.push(t);cargos.sort(function(n,t){var i=n.DataCargo.split("/"),u=new Date(i[2],i[1]-1,i[0]),r;return i=t.DataCargo.split("/"),r=new Date(i[2],i[1]-1,i[0]),u<r?1:u>r?-1:0});MontarGridCargos(cargos);$("#btnAddCargo").val("Adicionar");$("#CargoId").val("");$("#DataCargo").val("");$("#LocalConsagracao").val("");$("#Confradesp").val("");$("#CGADB").val("");$("#Confradesp").prop("disabled",!0);$("#CGADB").prop("disabled",!0);permiteexcluircargomembro&&!isreadonly&&HabilitarBotoesTabela($(document.getElementById("tbCargos").getElementsByTagName("tbody")),!1)});$("#CargoId").blur(function(){var t=$(this).val(),n=EncontrarItem(dadosCargos,function(n){return n.Id==t});n!=undefined&&n!=null&&n.length>0?(n[0].Confradesp?$("#Confradesp").prop("disabled",!1):($("#Confradesp").prop("disabled",!0),$("#Confradesp").val("")),n[0].CGADB?$("#CGADB").prop("disabled",!1):($("#CGADB").prop("disabled",!0),$("#CGADB").val(""))):($("#Confradesp").prop("disabled",!0),$("#Confradesp").val(""),$("#CGADB").prop("disabled",!0),$("#CGADB").val(""))});$(document).on("click","#btnCancObs",{},function(n){n.preventDefault();$("#Observacao").val("");$("#DataCadastroObs").val("");indexObs=-1;$("#btnAddObs").val("Adicionar");HabilitarBotoesTabela($(document.getElementById("tbObs").getElementsByTagName("tbody")),!1)});$(document).on("click","#btnAddObs",{},function(n){var t,f,u,i,r;if(n.preventDefault(),t=CarregarDadosObservacao($("#Observacao").val(),$("#DataCadastroObs").val(),$("#nomeUsuarioObs").val(),$("#idUsuarioObs").val(),!0),f=$(document).find("[data-valmsg-for='Observacao']"),f.html(""),u=$(document).find("[data-valmsg-for='DataCadastroObs']"),u.html(""),i=!1,(t.Observacao==null||t.Observacao==undefined||t.Observacao==0)&&(i=!0,f.html('<span id="Observacao-error" class="">O campo Observação é obrigatório<\/span>')),(t.DataCadastroObs==null||t.DataCadastroObs==undefined||t.DataCadastroObs==0)&&(i=!0,u.html('<span id="DataCadastroObs-error" class="">O campo Data de Cadastro é obrigatório<\/span>')),t.DataCadastroObs!=null&&t.DataCadastroObs!=undefined&&t.DataCadastroObs!=""&&(r=new Date,r.setYear(t.DataCadastroObs.split("/")[2]),r.setMonth(t.DataCadastroObs.split("/")[1]-1),r.setDate(t.DataCadastroObs.split("/")[0]),r.getTime()>(new Date).getTime()&&(u.html('<span id="DataCadastroObs-error" class="">A Data de Cadastro da Observação deve ser menor que a Data Atual<\/span>'),i=!0)),i)return!1;indexObs>-1&&(obs.splice(indexObs,1),indexObs=-1);obs.push(t);obs.sort(function(n,t){var i=n.DataCadastroObs.split("/"),u=new Date(i[2],i[1]-1,i[0]),r;return i=t.DataCadastroObs.split("/"),r=new Date(i[2],i[1]-1,i[0]),u<r?1:u>r?-1:0});MontarGridObs(obs);$("#btnAddObs").val("Adicionar");$("#Observacao").val("");$("#DataCadastroObs").val("");permiteexcluirobservacaomembro&&!isreadonly&&HabilitarBotoesTabela($(document.getElementById("tbObs").getElementsByTagName("tbody")),!1)});$("#Arquivo").on("change",function(n){var t=this.value.split(".").pop();typeof["pdf"].find(n=>t.toLowerCase()==n)=="undefined"?($.alertError("Upload de Arquivo","Somente arquivos do Tipo PDF são permitidos para Upload."),this.value=""):files=n.target.files});$(document).on("click","#btnAddArq",{},function(){var f=$("#Id").val(),t=$("#DescricaoArquivo").val(),i=!1,r=$(document).find("[data-valmsg-for='Arquivo']"),u=$(document).find("[data-valmsg-for='DescricaoArquivo']"),n;r.html("");u.html("");(t==null||t==""||t==undefined)&&(u.html('<span id="DescricaoArquivo-error" class="">Descrição do Arquivo é obrigatório<\/span>'),i=!0);files==null||files==undefined||files.length==0?(r.html('<span id="Arquivo-error" class="">Você deve selecionar um Arquivo<\/span>'),i=!0):files[0].size>2097152&&(r.html('<span id="Arquivo-error" class="">Arquivo maior que 2 MB. Tamanho do arquivo selecionado: {0}.<\/span>'.format(bytesToSize(files[0].size))),i=!0);i||(n=null,files!=null&&files!=undefined&&files.length>0&&(n=files[0]),arquivos.push(CarregarDadosArquivo(!1,null,0,f,null,null,null,null,null,null,n,null,t,n.name,n.size,!1,!1,gera_id())),MontarGridArquivo(),$("#Arquivo").val(""),$("#DescricaoArquivo").val(""))});$(document).on("click","#btnCancArq",{},function(){$("#Arquivo").val("");$("#DescricaoArquivo").val("")});$("#Cadastrado").change(function(){LimparCamposCurso();$("#CursoId").val("");var n=$("option:selected",$(this)).text();HabilitarCamposCurso(n=="Sim")});HabilitarCamposCurso(!1);$.ajaxPost("/Secretaria/Membro/DadosCursos",null,function(n){dadosCursos=n});$("#CursoId").on("change",function(){var n=$("option:selected",$("#CursoId")).val();CarregarDadosCurso(n)});$("#ArquivoCurso").on("change",function(n){var t=this.value.split(".").pop();typeof["pdf"].find(n=>t.toLowerCase()==n)=="undefined"?($.alertError("Upload de Arquivo","Somente arquivos do Tipo PDF são permitidos para Upload."),this.value=""):fileCurso=n.target.files});$(document).on("click","#btnAddCurso",{},function(){var g=$("#Id").val(),w=$("option:selected",$("#Cadastrado")).text(),b=$(document).find("[data-valmsg-for='CursoId']"),s,h,c,i,l,a;b.html("");s=$(document).find("[data-valmsg-for='Local']");s.html("");h=$(document).find("[data-valmsg-for='NomeCurso']");h.html("");c=$(document).find("[data-valmsg-for='DataInicioCurso']");c.html("");i=$(document).find("[data-valmsg-for='DataEncerramentoCurso']");i.html("");l=$(document).find("[data-valmsg-for='CargaHoraria']");l.html("");a=$(document).find("[data-valmsg-for='ArquivoCurso']");a.html("");var v=0,r=$("#Local").val(),u=$("#NomeCurso").val(),f=$("#DataInicioCurso").val(),e=$("#DataEncerramentoCurso").val(),t=$("#CargaHoraria").val(),n=!1;if(w=="Sim")v=$("option:selected",$("#CursoId")).val(),v==0&&(b.html('<span id="DescricaoArquivo-error" class="">Curso é obrigatório<\/span>'),n=!0);else{var y=$("#DataInicioCurso").val().split("/"),nt=new Date(y[1]+"/"+y[0]+"/"+y[2]),p=$("#DataEncerramentoCurso").val().split("/"),tt=new Date(p[1]+"/"+p[0]+"/"+p[2]);(r==null||r==""||r==undefined)&&(s.html('<span id="Local-error" class="">Local do curso é obrigatório<\/span>'),n=!0);(u==null||u==""||u==undefined)&&(h.html('<span id="NomeCurso-error" class="">Nome do curso é obrigatório<\/span>'),n=!0);(f==null||f==""||f==undefined)&&(c.html('<span id="DataInicioCurso-error" class="">Data Início do curso é obrigatório<\/span>'),n=!0);(e==null||e==""||e==undefined)&&(i.html('<span id="DataEncerramentoCurso-error" class="">Data de Encerramento do curso é obrigatório<\/span>'),n=!0);tt<nt&&(i.html('<span id="DataEncerramentoCurso-error" class="">Data de Encerramento deve ser maior ou igual a Data de Início.<\/span>'),n=!0);(t==null||t==""||t==undefined||parseInt(t)==0)&&(l.html('<span id="CargaHoraria-error" class="">Carga Horária é obrigatório<\/span>'),n=!0);fileCurso!=null&&fileCurso!=undefined&&fileCurso.length>0&&fileCurso[0].size>2097152&&(a.html('<span id="ArquivoCurso-error" class="">Arquivo maior que 2 MB. Tamanho do arquivo selecionado: {0}.<\/span>'.format(bytesToSize(fileCurso[0].size))),n=!0)}if(!n){var o=null,k=null,d=null;fileCurso!=null&&fileCurso!=undefined&&fileCurso.length>0&&(o=fileCurso[0],k=o.name,d=o.size);arquivos.push(CarregarDadosArquivo(!0,w,0,g,v,u,r,f,e,t,null,o,null,k,d,!1,!1,gera_id()));MontarGridCursos();LimparCamposCurso(!0)}});$(document).on("click","#btnCancCurso",{},function(){LimparCamposCurso(!0);$("#CursoId").val("")})}$("#lnkBuscarCongregacao").removeAttr("class");i=$("#hdnUsuarioSede").val().toLowerCase()==="true";i===!1?($("#CongregacaoId").attr("readonly","readonly"),$("#lnkBuscarCongregacao").attr("class","disabled")):$("#lnkBuscarCongregacao").popUp("","Congregacao","CongregacaoId");$("#CongregacaoId").blur(function(){var n=$(this).val();PesquisarCongregacao(n)});$("#DataPrevistaBatismo").blur(function(){var n=$(this).val(),i=$(document).find("[data-valmsg-for='DataPrevistaBatismo']"),t;return i.html(""),n!=null&&n!=undefined&&n!=""&&(t=new Date,t.setYear(n.split("/")[2]),t.setMonth(n.split("/")[1]-1),t.setDate(n.split("/")[0]),t.getTime()<(new Date).getTime())?(i.html('<span id="DataPrevistaBatismo-error" class="">A Data prevista para o Batismo deve ser maior que a Data Atual<\/span>'),!1):void 0});$(document).on("click","#btnReprovar",{},function(n){n.preventDefault();var t={Id:$(this).data("membroid")},i="/Secretaria/Membro/ReprovarMembroMotivo/"+t.Id;$.popUpUrl(i,440,640)});$(document).on("click","#btnAprovarMembro",{},function(n){n.preventDefault();$.showYesNoAlert("Deseja realmente Aprovar o membro?","Membro",function(){var n={id:$("#Id").val()};$.ajaxPost(urlAprovarMembro,n,function(n){n.status==="OK"?window.location.href=n.url:$.alertError("Membro",n.mensagem)})})});$(document).on("click","#lnkCarteirinha",{},function(n){n.preventDefault();var t=$(this).data("membroid");GerarCarteirinha(t,$(this))});$("#lnkFichaMembro").click(n=>{n.preventDefault(),Swal.fire({title:"<strong>Membro<\/strong>",html:"Deseja imprimir a Ficha de Membro?",icon:"question",input:"checkbox",inputValue:0,inputPlaceholder:"Imprimir Cursos/Eventos do Membro",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:'<i class="fa fa-check-circle"><\/i> Sim',cancelButtonText:'<i class="fa fa-ban"><\/i> Não',width:500,allowOutsideClick:!1}).then(n=>{if(n.value===0||n.value){let t=$("#lnkFichaMembro").data("membroid"),i=`${urlFichaMembro}?id=${t}&imprimirCurso=${n.value===1}`;$.downloadArquivo(i,$("#lnkFichaMembro"))}})});$(document).on("click","#lnkExcluir",{},function(n){n.preventDefault();var t={id:$(this).data("membroid")};$.showYesNoAlert('<h3 style="color:red">Você tem certeza que deseja excluir este Membro?<\/br>Após a confirmação NÃO será mais possível recuperar os dados e nem os arquivos salvos para o Membro.<\/h3>',"Membro",function(){$.ajaxPost(urlExcluir,t,function(n){n.status=="OK"?window.location=n.url:$.alertError("Membro",n.mensagem)})})});$(document).on("click","#btnSalvar",{},function(n){n.preventDefault;var t="Deseja realmente criar um novo Membro?";$("#Acao").val()=="Update"&&(t="Deseja realmente atualizar o Membro?");$.showYesNoAlert(t,"Membro",function(){var t=$("#frmMembro"),i,n;t.validate();t.valid()?($("#Obs").val(JSON.stringify(obs)),$("#Sit").val(JSON.stringify(sit)),$("#Carg").val(JSON.stringify(cargos)),ExistsFileToSave()?(i=$("#modalSalvar table")[0].getElementsByTagName("tbody")[0],$(i).empty(),$("#modalSalvar").modal({backdrop:"static"}),AddRowGridModal(0,"Salvando os dados do Membro"),$.ajaxPostForm(urlSubmit,$("#frmMembro"),function(n){var t,f,i,r,e,u;if(n.status=="OK"){for(urlFechar=n.url,$('#modalSalvar tbody tr[name="row0"').find('span[id="lbl0"]').html(n.msg),$('#modalSalvar tbody tr[name="row0"').find('div[id="div0"]').html('<span class="label label-success">Finalizado<\/span>'),t=0;t<arquivos.length;t++)arquivos[t].MembroId=n.membroid;for(t=0;t<arquivos.length;t++)f="/Secretaria/Membro/SalvarExcluirArquivos",arquivos[t].IsDelete&&arquivos[t].IsSave||!arquivos[t].IsDelete&&!arquivos[t].IsSave?window.FormData!==undefined&&(i=new FormData,(arquivos[t].ArquivoCurso!=null&&arquivos[t].ArquivoCurso!=undefined||arquivos[t].Arquivo!=null&&arquivos[t].Arquivo!=undefined)&&(arquivos[t].IsCurso?i.append("files",arquivos[t].ArquivoCurso):i.append("files",arquivos[t].Arquivo)),r=null,arquivos[t].IsCurso&&(r=arquivos[t].Cadastrado=="Não"?0:1),e=CarregarDadosArquivo(arquivos[t].IsCurso,r,arquivos[t].Id,arquivos[t].MembroId,arquivos[t].CursoId,arquivos[t].NomeCurso,arquivos[t].Local,arquivos[t].DataInicioCurso,arquivos[t].DataEncerramentoCurso,arquivos[t].CargaHoraria,null,null,arquivos[t].DescricaoArquivo,arquivos[t].NomeOriginal,arquivos[t].Tamanho,arquivos[t].IsDelete,arquivos[t].IsSave,arquivos[t].Index),i.append("model",JSON.stringify(e)),$.ajax({type:"POST",url:f,contentType:!1,processData:!1,data:i,beforeSend:function(){arquivos[t].IsCurso?arquivos[t].IsDelete?AddRowGridModal(arquivos[t].Index,'Excluindo o Curso <b>"{0}"<\/b>'.format(arquivos[t].NomeCurso)):AddRowGridModal(arquivos[t].Index,'Salvando o Curso <b>"{0}"<\/b>'.format(arquivos[t].NomeCurso)):arquivos[t].IsDelete?AddRowGridModal(arquivos[t].Index,'Excluindo o Documento <b>"{0}"<\/b>'.format(arquivos[t].DescricaoArquivo)):AddRowGridModal(arquivos[t].Index,'Salvando o Documento <b>"{0}"<\/b>'.format(arquivos[t].DescricaoArquivo))},success:function(n){var t='#modalSalvar tbody tr[name="row{0}"]'.format(n.index),r='span[id="lbl{0}"]'.format(n.index),u='div[id="div{0}"]'.format(n.index),i;n.status=="OK"?($(t).find(r).html(n.msg),$(t).find(u).html('<span class="label label-success">Finalizado<\/span>')):($(t).find(r).html("<b>{0}<\/b>".format(n.msg)),$(t).find(u).html('<span class="label label-danger">Erro<\/span>'));i=EncontrarIndice(arquivos,function(t){return t.Index==n.index});i>-1&&(arquivos[i].IsSave=!0,arquivos[i].IsDone=!0);HabilitarBotaoModal(arquivos)&&$("#divFooter").css("display","block")}})):arquivos[t].IsDone=!0}else return u=$('#modalSalvar tbody tr[name="row0"'),u.find('span[id="lbl0"]').html(n.msg),u.find('div[id="div0"]').html('<span class="label label-danger">Erro<\/span>'),$("#divFooter").css("display","block"),urlFechar="",!1})):$.ajaxPostForm(urlSubmit,$("#frmMembro"),function(n){n.status==="OK"?window.location=n.url:$.alertError("Membro",n.msg)})):(n=ValidarFormulario(),n!=null&&n!=undefined&&n!=""&&$.alertError("Membro",n))})});$(document).on("click","#btnFecharModal",{},function(n){urlFechar!=""&&urlFechar!=null&&urlFechar!=undefined&&(n.preventDefault,window.location=urlFechar)});$(document).on("click","#btnEnviarBatismo",{},function(n){n.preventDefault;$.showYesNoAlert("Deseja realmente enviar o Membro para o Batismo?","Envio para o Batismo",function(){var t=$("#frmMembro"),n;t.validate();t.valid()?$.ajaxPostForm(urlEnvBatismo,$("#frmMembro"),function(n){n.status==="OK"?window.location=n.url:$.alertError("Envio para o Batismo",n.msg)}):(n=ValidarFormEnvioBatismo(),n!==null&&n!==undefined&&n!==""&&$.alertError("Envio para o Batismo",n))})});$("#btnMembroConfirmado").click(()=>{let n=$("#Id").val(),t=`${urlMembroConfirmado}?id=${n}`;$.popUpUrl(t,600,700)})});$(function(){"use strict";dom={uploader:$("#uploader"),uploads:$("#divFoto"),fileDescription:$("#arquivoDescricao"),fotoBorder:$("#fotoBorder"),removeFile:$("#removeFile"),hdnFoto:$("#Pessoa_FotoPath")};removerBordaFoto();var n=new plupload.Uploader({runtimes:"html5",url:pathUrl,drop_element:"uploader",browse_button:"selectFiles",container:"uploader",max_file_size:"1024mb",resize:{width:180,height:230,quality:90},filters:[{title:"Arquivo de Imagem",extensions:"jpg,png"}]});n.bind("QueueChanged",function(n){n.files.length>1&&n.files.splice(0,1);for(var t=0;t<n.files.length;t++)showImagePreview(n.files[t]),setTimeout(function(){var n=$(".arquivoFoto").attr("src");n!=undefined&&removerBordaFoto();$(dom.hdnFoto).val(n)},300)});n.init();$(dom.removeFile).on("click",function(){n.files.length>1&&n.files.splice(0,1);removerFoto();$(this).css("display","none")})});
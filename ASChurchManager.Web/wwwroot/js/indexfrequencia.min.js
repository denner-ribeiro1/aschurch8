function FormataData(n){n=n.split("T");let i=n[0],t=i.split("-");return`${t[2]}/${t[1]}/${t[0]}`}function FormataHora(n){return n=n.split("T"),`${n[1]}`}function FormataDataHora(n){n=n.split("T");let i=n[0],t=i.split("-");return`${t[2]}/${t[1]}/${t[0]} - ${n[1]}`}function CarregarTable(n){let i=document.getElementById("tbEvento").getElementsByTagName("tbody")[0];if($(i).empty(),n.length>0)for(var t=0;t<n.length;t++)IncluirLinhaTabela(n[t],t);else{let n=i.insertRow(0);n.className="jtable-data-row";$.incluirCelulasTabela(n,0,"100%","Não há Cursos/Eventos iniciados.",2)}}function IncluirLinhaTabela(n,t){let i=document.getElementById("tbEvento").getElementsByTagName("tbody")[0];for(var t=0;t<n.Datas.length;t++){let r=i.insertRow(t);r.className="jtable-data-row"+(t%2==0?" jtable-row-even":"");let{DataHoraInicio:f,DataHoraFim:e,Id:o}=n.Datas[t],u="";u+=`<button type="button" class="btn btn-app" style="margin-left: 5px;margin-top:10px;padding: 9px 5px;height:52px" onclick="PararFrequencia(${o}, ${n.Id}, this);">
                       <i class="fa fa-pause"></i> Parar
                   </button>`;$.incluirCelulasTabela(r,0,null,u);let s=`${n.Descricao} - Início: ${FormataDataHora(f)} - Fim: ${FormataDataHora(e)}`;$.incluirCelulasTabela(r,1,null,s)}}function PararFrequencia(n,t){let i={presencaId:t,dataId:n};$.ajaxPost(urlIniciarLista,i,function(n){n.status=="OK"?(CarregarTable(n.data),($("option:selected",$("#PresencaId")).text()!=null||$("option:selected",$("#PresencaId")).text()!="")&&$("#PresencaId").change()):$.bsMessageError("Atenção",n.Message)})}function createPopupWin(n,t,i,r){var u=(screen.width-i)/2,f=(screen.height-r)/4,e=window.open(n,t,"resizable=yes, width="+i+", height="+r+", top="+f+", left="+u)}$(()=>{CarregarTable(lPresAnd),$("#PresencaId").change(n=>{n.preventDefault;let t={idPresenca:$("option:selected",$("#PresencaId")).val()};$.ajaxPost(urlBuscarDatas,t,function(n){var t,i;if(n.status=="OK"){let r=n.data;for($("#DataId").empty(),t=0;t<r.length;t++){i=$("<option><\/option>").appendTo($("#DataId"));i.attr("value",r[t].Id);let n=`${FormataData(r[t].DataHoraInicio)} - Início: ${FormataHora(r[t].DataHoraInicio)} - Fim: ${FormataHora(r[t].DataHoraFim)}`;i.html(n)}}else $.bsMessageError("Atenção",n.Message)})}),$("#btnIniciar").click(n=>{if(n.preventDefault,$("option:selected",$("#PresencaId")).text()==null||$("option:selected",$("#PresencaId")).text()==""){$.bsMessageError("Atenção","Favor selecionar um Curso/Evento!");$("#PresencaId").focus();return}if($("option:selected",$("#DataId")).text()==null||$("option:selected",$("#DataId")).text()==""){$.bsMessageError("Atenção","Favor selecionar uma Data!");$("#DataId").focus();return}let t={presencaId:$("option:selected",$("#PresencaId")).val(),dataId:$("option:selected",$("#DataId")).val(),tipo:"AND"};$.ajaxPost(urlIniciarLista,t,function(n){n.status=="OK"?(CarregarTable(n.data),($("option:selected",$("#PresencaId")).text()!=null||$("option:selected",$("#PresencaId")).text()!="")&&$("#PresencaId").change()):$.bsMessageError("Atenção",n.Message)})}),$("#btnRegistrar").click(n=>{n.preventDefault,createPopupWin(urlPopUp,"Frequencia",1200,650)})});
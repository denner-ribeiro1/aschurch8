function FormataData(n){n=n.split("T");let i=n[0],t=i.split("-");return`${t[2]}/${t[1]}/${t[0]}`}function FormataHora(n){return n=n.split("T"),`${n[1]}`}$(function(){"use strict";$("#ViewModelTitle").val()=="PresencaLista"&&($('select[name="duallistbox_cargos[]"]').bootstrapDualListbox({nonSelectedListLabel:"Não Selecionados",selectedListLabel:"Selecionados",preserveSelectionOnMove:"moved",moveOnSelect:!1}),$('select[name="duallistbox_eventos[]"]').bootstrapDualListbox({nonSelectedListLabel:"Não Selecionados",selectedListLabel:"Selecionados",preserveSelectionOnMove:"moved",moveOnSelect:!1}));$("#DataFinal").blur(function(){var t=$("#DataInicio").val(),i=$("#DataFinal").val(),r=Date.parse(t),u=Date.parse(i),n=$(document).find("[data-valmsg-for='DataInicio']");n.html("");r>u&&n.html('<span id="DataInicio-error" class="">O campo Data Inicial é maior do que a Data Final<\/span>')});$("#btnRelCandidatoBatismo").click(function(n){n.preventDefault();let i=$("option:selected",$("#DataBatismo")).val(),t=$("option:selected",$("#DataBatismo")).text();t==="Todas"&&(i="0",t="0");let r=$("option:selected",$("#Congregacao")).val(),u=$("option:selected",$("#Situacao")).text(),f=$("#TipoSaida").val(),e=`${urlRelCadBat}?congregacao=${r}&batismoId=${i}&dataBatismo=${t.replace("/","-").replace("/","-")}&situacao=${u}&formato=${f}`;$.downloadArquivo(e,$("#btnRelCandidatoBatismo"))});$("#btnRelAniversariantes").click(function(n){n.preventDefault();let t=$("option:selected",$("#Congregacao")).val(),i=$("#DataInicio").val(),r=$("#DataFinal").val(),u=$("option:selected",$("#TipoMembro")).val(),f=$("#TipoSaida").val(),e=`${urlRelAniv}?congregacao=${t}&dataInicio=${i.replace("/","-").replace("/","-")}&dataFinal=${r.replace("/","-").replace("/","-")}&tipoMembro=${u}&formato=${f}`;$.downloadArquivo(e,$("#btnRelAniversariantes"))});$("#btnRelNascimentos").click(function(n){n.preventDefault();let t=$("option:selected",$("#Congregacao")).val(),i=$("#DataInicio").val(),r=$("#DataFinal").val(),u=$("#TipoSaida").val(),f=`${urlRelNasc}?congregacao=${t}&dataInicio=${i.replace("/","-").replace("/","-")}&dataFinal=${r.replace("/","-").replace("/","-")}&formato=${u}`;$.downloadArquivo(f,$("#btnRelNascimentos"))});$("#btnRelCasamento").click(function(n){n.preventDefault();let t=$("option:selected",$("#Congregacao")).val(),i=$("#DataInicio").val(),r=$("#DataFinal").val(),u=$("#TipoSaida").val(),f=`${urlCasam}?congregacao=${t}&dataInicio=${i.replace("/","-").replace("/","-")}&dataFinal=${r.replace("/","-").replace("/","-")}&formato=${u}`;$.downloadArquivo(f,$("#btnRelCasamento"))});$("#btnRelTransferencia").click(function(n){n.preventDefault();let t=$("#Congregacao").val(),i=$("#DataInicio").val(),r=$("#DataFinal").val(),u=$("#TipoSaida").val(),f=`${urlTrans}?congregacao=${t}&dataInicio=${i.replace("/","-").replace("/","-")}&dataFinal=${r.replace("/","-").replace("/","-")}&formato=${u}`;$.downloadArquivo(f,$("#btnRelTransferencia"))});$("#btnRelCongregacao").click(function(n){n.preventDefault();let t=$("#Congregacao").val(),i=$("#TipoSaida").val(),r=`${urlCongr}?congregacao=${t}&formato=${i}`;$.downloadArquivo(r,$("#btnRelCongregacao"))});$("#btnRelObreiros").click(function(n){n.preventDefault();let t=$("#Congregacao").val(),i=$("#TipoSaida").val(),r=`${urlRelObr}?congregacao=${t}&formato=${i}`;$.downloadArquivo(r,$("#btnRelObreiros"))});$("#Congregacao").blur(function(){var n=$(this).val(),t;n!=null&&n!=undefined&&n!=""&&(t=$(document).find("[data-valmsg-for='Congregacao']"),t.html(""))});$("#Mes").blur(function(){var n=$(this).val(),t;n!=null&&n!=undefined&&n!="0"&&n!=""&&(t=$(document).find("[data-valmsg-for='Mes']"),t.html(""))});$("#Ano").blur(function(){var n=$(this).val(),t;n!=null&&n!=undefined&&n!="0"&&n!=""&&(t=$(document).find("[data-valmsg-for='Ano']"),t.html(""))});$("#btnRelatorioMensal").click(function(n){var u,f,e,o;n.preventDefault();var i=$("#Congregacao").val(),t=$("option:selected",$("#Mes")).val(),r=$("#Ano").val();if(i==null||i=="")return u=$(document).find("[data-valmsg-for='Congregacao']"),u.html('<span id="Congregacao-error" class="">Congregação é de preenchimento obrigatório<\/span>'),!1;if(t==null||t=="0"||t=="")return f=$(document).find("[data-valmsg-for='Mes']"),f.html('<span id="Mes-error" class="">Mês é de preenchimento obrigatório<\/span>'),!1;if(r<1950||r>2050)return e=$(document).find("[data-valmsg-for='Ano']"),e.html('<span id="Ano-error" class="">Ano deve ser maior que 1950 e menor de 2050<\/span>'),!1;o="/Secretaria/Relatorios/RelatorioMensal?congregacao="+i+"&mes="+t+"&ano="+r;$.downloadArquivo(o,$("#btnRelatorioMensal"))});$("#btnRelMembro").click(function(n){n.preventDefault();let t=$("#Congregacao").val(),i=$("option:selected",$("#Status")).val(),r=$("option:selected",$("#TipoMembro")).val(),u=$("option:selected",$("#EstadoCivil")).val(),o=$("#ABEDABE").is(":checked"),s=$("#Completo").is(":checked"),f=$("#Confirmados").prop("checked"),e=$("#AtivosConfirmados").is(":checked"),h=$("#TipoSaida").val();if(t===""&&i==="NaoDefinido"&&r==="NaoDefinido"&&u==="NaoDefinido")$.alertError("Relatório de Membros","Favor selecionar pelo menos uma Opção: Congregação/Status/Tipo de Membro/Estado Civil.");else{f==!1&&(e=!1);let n=`${urlRelMembros}?congregacaoId=${t}&status=${i}&tipoMembro=${r}&estadocivil=${u}&simplificado=${s}&abedabe=${o}&filtrarConf=${f}&ativosConf=${e}&formato=${h}`;$.downloadArquivo(n,$("#btnRelMembro"))}});$("#btnRelCursosMembro").click(function(n){n.preventDefault();let t=$("option:selected",$("#Congregacao")).val(),i=$("option:selected",$("#Cursos")).val(),r=$("#TipoSaida").val(),u=`${urlRelCur}?congregacaoId=${t}&cursoId=${i}&formato=${r}`;$.downloadArquivo(u,$("#btnRelCursosMembro"))});$("#btnEventos").click(function(n){var f,e;n.preventDefault();var i=$("#Congregacao").val(),r=$("option:selected",$("#Mes")).val(),t=$("#Ano").val(),u=$("#TipoEvento").val(),o=$("#Completo").is(":checked");if(t<1950||t>2050)return f=$(document).find("[data-valmsg-for='Ano']"),f.html('<span id="Ano-error" class="">Ano deve ser maior que 1950 e menor de 2050<\/span>'),!1;e=`/Secretaria/Relatorios/RelatorioEventos?congregacao=${i!=""?i:"0"}&mes=${r!=""?r:"0"}&ano=${t}&tipoEvento=${u!=""?u:"0"}&simplificado=${o}`;$.downloadArquivo(e,$("#btnEventos"))});$("#PresencaId").change(n=>{if(n.preventDefault,$("#DataId").length){let n=$("option:selected",$("#PresencaId")).val(),t={idPresenca:n};$.ajaxPost(urlBuscarDatas,t,function(n){if(n.status=="OK"){let i=n.data;$("#DataId").empty();let r=$("<option><\/option>").appendTo($("#DataId"));r.attr("value","");r.html("Todas");for(var t=0;t<i.length;t++){r=$("<option><\/option>").appendTo($("#DataId"));r.attr("value",i[t].Id);let n=`Data: ${FormataData(i[t].DataHoraInicio)} - Hora Início: ${FormataHora(i[t].DataHoraInicio)} - Hora Fim: ${FormataHora(i[t].DataHoraFim)}`;r.html(n)}}else $.bsMessageError("Atenção",n.Message)})}});$("#btnRelPresInscritos").click(n=>{var i,t;n.preventDefault();i=$("option:selected",$("#PresencaId")).val();t=$("#CongregacaoId").val();(t==null||t=="")&&(t=$("option:selected",$("#CongregacaoId")).val());var r=$("option:selected",$("#TipoInscricao")).val(),u=$("#Carimbo").is(":checked"),f=`${urlRelInscr}?idPresenca=${i}&congregacao=${t}&tipo=${r}&carimbo=${u}`;$.downloadArquivo(f,$("#btnRelPresInscritos"))});$("#btnRelPresFreq").click(n=>{n.preventDefault();let t=$("option:selected",$("#PresencaId")).val();if(t==0){$.alertError("Relatório de Frequência","Favor selecionar um Curso/Evento!");return}let i=$("option:selected",$("#DataId")).val(),r=$("option:selected",$("#CongregacaoId")).val(),u=$("option:selected",$("#SituacaoSelecionado")).val(),f=$("#TipoSaida").val();var e=`${urlRelFreq}?idPresenca=${t}&idData=${i}&congregacao=${r}&situacao=${u}&formato=${f}`;$.downloadArquivo(e,$("#btnRelPresFreq"))});$("#btnRelPresLista").click(n=>{n.preventDefault();let t=[],i=$(document).find("[data-valmsg-for='DataInicio']"),r=$(document).find("[data-valmsg-for='DataFinal']"),u=$(document).find("[data-valmsg-for='DataFinal']");if(i.html(""),r.html(""),u.html(""),$("#DataInicio").val()==""||$("#DataFinal").val()=="")$("#DataInicio").val()==""&&(i.html("Data Inicio é de preenchimento obrigatório."),t.push("Data Inicio é de preenchimento obrigatório.")),$("#DataFinal").val()==""&&(r.html("Data Final é de preenchimento obrigatório."),t.push("Data Final é de preenchimento obrigatório."));else{let n=$("#DataInicio").val().split("/"),r=new Date(n[2],n[1]-1,n[0]),i=$("#DataFinal").val().split("/"),f=new Date(i[2],i[1]-1,i[0]);r>=f&&(t.push("Data Final deve ser maior que a Data Inicial."),u.html("Data Final deve ser maior que a Data Inicial"))}if($('[name="duallistbox_cargos[]"]').val().length<=0&&t.push("Deve ser selecionado pelo menos um Cargo."),$('[name="duallistbox_eventos[]"]').val().length<=0&&t.push("Deve ser selecionado pelo menos um Tipo de Evento."),t.length>0){let n=t.join("<br />");$.alertError("Relatório",n)}else{let n=$("option:selected",$("#CongregacaoId")).val(),t=$("#DataInicio").val(),i=$("#DataFinal").val(),r=$('[name="duallistbox_cargos[]"]').val().join("_"),u=$('[name="duallistbox_eventos[]"]').val().join("_"),f=`${urlRelFreqLista}?congregacao=${n}&datainicio=${t}&datafinal=${i}&cargos=${r}&eventos=${u}`;$.downloadArquivo(f,$("#btnRelPresLista"))}});$("#Confirmados").on("ifChanged",function(n){n.preventDefault;$("#Confirmados").prop("checked")==!0?($("#TipoMembro").val("Membro"),$("#TipoMembro").attr("disabled",!0),$("#Status").val("Ativo"),$("#Status").attr("disabled",!0),$("#divConf").show()):($("#TipoMembro").val(""),$("#TipoMembro").removeAttr("disabled"),$("#Status").val(""),$("#Status").removeAttr("disabled"),$("#divConf").hide())})});
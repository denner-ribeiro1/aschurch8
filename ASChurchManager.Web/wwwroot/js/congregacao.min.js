function ValidarFormulario(){var n="";return $(".tab-pane").find("span[id*=-error]").each(function(t,i){$(i).text()!=""&&(n+=$(i).text()+"<br>")}),n}function CarregarMembro(n,t,i){var r=$(n).val(),u;r>0&&(u={MembroId:r},$.ajaxPost("/Secretaria/Membro/BuscarMembro",u,function(r){if(r.Id==0)$.alertError("Atenção","Código inválido!"),$(n).val("");else if(r.Status!=1)$.alertError("Atenção","Membro não Ativo!"),$(n).val("");else if(i&&r.Cargos.length==0)$.alertError("Atenção","Membro não possui Cargos cadastrado!"),$(n).val("");else if(r.Id>0)return $(t).val(r.Nome),r}))}function CarregarObreiro(n,t,i){return{ObreiroId:n,ObreiroNome:t,ObreiroCargo:i}}function ExcluirRowObr(n){$.showYesNoAlert("Deseja excluir o Obreiro?","Excluir Obreiro",function(){var t=n.parentNode.parentNode.sectionRowIndex,i=document.getElementById("tbObreiro").getElementsByTagName("tbody")[0],r;i.deleteRow(t);obreiros.splice(t,1);obreiros.length==0&&(r=i.insertRow(0),$.incluirCelulasTabela(r,0,"100%","Não há Obreiros cadastrados para o Congregação",4))})}function CarregarGrupo(n,t,i,r,u){return{GrupoId:n,Grupo:t,NomeGrupo:i,ResponsavelId:r,ResponsavelNome:u}}function ExcluirRowGrp(n){$.showYesNoAlert("Deseja excluir o Grupo?","Excluir Grupo",function(){var t=n.parentNode.parentNode.sectionRowIndex,i=document.getElementById("tbGrupo").getElementsByTagName("tbody")[0],r;i.deleteRow(t);grupos.splice(t,1);grupos.length==0&&(r=i.insertRow(0),$.incluirCelulasTabela(r,0,"100%","Não há Grupos cadastrados para o Congregação",5))})}function AtualizarRowObs(n){var t=n.parentNode.parentNode.sectionRowIndex;indexObs=t;$("#Observacao").val(observacoes[t].Observacao);$("#btnAddObs").html('<span class="glyphicon glyphicon-edit"><\/span> Atualizar \n');$("#btnAddObs").removeClass("btn-primary");$("#btnAddObs").addClass("btn-info");$("#Observacao").focus();HabilitarBotoesTabela($(document.getElementById("tbObs").getElementsByTagName("tbody")),!0)}function MontarGridObs(n){var r=document.getElementById("tbObs").getElementsByTagName("tbody")[0],t,i,u;for($(r).empty(),t=0;t<n.length;t++)i=r.insertRow(t),i.className="jtable-data-row"+(t%2==0?" jtable-row-even":""),$.incluirCelulasTabela(i,0,null,n[t].Observacao),$.incluirCelulasTabela(i,1,null,n[t].DataCadastroObs),$.incluirCelulasTabela(i,2,null,n[t].ResponsavelObs),u=' <button type="button" class="btn btn-info btn-sm" onclick="AtualizarRowObs(this);"><span class="glyphicon glyphicon-refresh"><\/span> Atualizar<\/button> <button type="button" class="btn btn-danger btn-sm" onclick="ExcluirRowObs(this);"><span class="glyphicon glyphicon-edit"><\/span> Excluir<\/button>',$.incluirCelulasTabela(i,3,null,u)}function CarregarObs(n,t,i,r){return{Observacao:n,DataCadastroObs:t,IdResponsavelObs:i,ResponsavelObs:r}}function ExcluirRowObs(n){$.showYesNoAlert("Deseja excluir a Observação?","Excluir Observação",function(){var t=n.parentNode.parentNode.sectionRowIndex,i=document.getElementById("tbObs").getElementsByTagName("tbody")[0],r;i.deleteRow(t);observacoes.splice(t,1);observacoes.length==0&&(r=i.insertRow(0),$.incluirCelulasTabela(r,0,"100%","Não há Observações cadastradas para o Congregação",5))})}function HabilitarBotoesTabela(n,t){$(n).find("tr").each(function(n,i){var r=$(i);$(r).find(".btn").each(function(n,i){$(i).prop("disabled",t)})})}function CarregarArquivos(n,t){if(n!=null&&n.length>0){let r="";$("#divCard").html("");let u=1;for(var i=0;i<n.length;i++)r+=Arquivo(n[i].Nome,n[i].Tamanho,n[i].Tipo.toLowerCase(),$("#Id").val(),t),u%6==0&&($("#divCard").append(`<div class="row" id="div${i}">`),$(`#div${i}`).append(r),r=""),u++;r!=""&&($("#divCard").append(`<div class="row" id="div${n.length}">`),$(`#div${n.length}`).append(r))}else $("#divCard").html("<label>Não há arquivos armazenados para o Curso/Evento.<\/label>")}function Arquivo(n,t,i,r,u){return`<div class="col-sm-5 col-lg-2 col-xl-1">
            <div class="file-man-box">
                ${u==!0?`<a href="javascript:void(0)" onclick="DeleteArquivo('${n}', ${r});return false;" class="file-close" title="Excluir Arquivo"><i class="glyphicon glyphicon-floppy-remove"></i></a>`:""}
                <div class="file-img-box"><img src="/images/${i}.svg" alt="${n}" title="${n}"></div>
                    <div class="file-man-title">
                        <h5 class="mb-0 text-overflow">${n}</h5>
                        <p class="mb-0"><small>${bytesToSize(t)}</small></p>
                    </div>
                    <a href="javascript:void(0)" onclick="DownloadArquivo('${n}', ${r});return false;" class="file-download" title="Baixar Arquivo"><i class="glyphicon glyphicon-download  file-img-dowload" style="margin: 10px"></i></a>
                </div>
            </div>`}function DownloadArquivo(n,t){let i=`${urlDownload}?id=${t}&nomeArquivo=${n}`;$.downloadArquivo(i,null)}function DeleteArquivo(n,t){$.showYesNoAlert(`Deseja excluir o arquivo ${n}?`,"Excluir Arquivo",function(){let i={id:t,nomeArquivo:n};$.ajaxPost(urlExcArq,i,function(n){n.status=="OK"?(arquivos=n.data,CarregarArquivos(arquivos,$("#Acao").val()=="Update")):$.bsMessageError("Atenção",n.Message)})})}function bytesToSize(n){var t;return n==0?"0 Byte":(t=parseInt(Math.floor(Math.log(n)/Math.log(1024))),Math.round(n/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t])}function AddRowGridModal(n,t,i,r){var e=$("#modalExcluir table")[0].getElementsByTagName("tbody")[0],f=e.insertRow(e.rows.length);f.setAttribute("name","row{0}".format(n));var o=f.insertCell(0),s=f.insertCell(1),h=f.insertCell(2);o.innerHTML='<span id="lblTpMemb{0}">{1}<\/span>'.format(n,t);s.innerHTML='<span id="lblStatus{0}">{1}<\/span>'.format(n,i);let u="";switch(t){case"Membros":u=' <button type="button" class="btn btn-info btn-sm" onclick="GerarRelMembro({0}, this);"><span class="glyphicon glyphicon-print"><\/span> Relatório<\/button>'.format(r);break;case"Eventos":u=' <button type="button" class="btn btn-info btn-sm" onclick="GerarRelEventos({0}, this);"><span class="glyphicon glyphicon-print"><\/span> Relatório<\/button>'.format(r);break;case"Casamentos":u=' <button type="button" class="btn btn-info btn-sm" onclick="GerarRelCasamento({0}, this);"><span class="glyphicon glyphicon-print"><\/span> Relatório<\/button>'.format(r);break;case"Nascimentos":u=' <button type="button" class="btn btn-info btn-sm" onclick="GerarRelNascimento({0}, this);"><span class="glyphicon glyphicon-print"><\/span> Relatório<\/button>'.format(r);break;case"Obreiros":u=' <button type="button" class="btn btn-info btn-sm" onclick="GerarRelObreiros({0}, this);"><span class="glyphicon glyphicon-print"><\/span> Relatório<\/button>'.format(r)}h.innerHTML=u}function GerarRelMembro(n,t){let i=`${urlRelMembros}?congregacaoId=${n}&simplificado=true`;$.downloadArquivo(i,$(t))}function GerarRelEventos(n,t){let i=`${urlRelEventos}?congregacao=${n}&tipoEvento=1&simplificado=true`;$.downloadArquivo(i,$(t))}function GerarRelCasamento(n,t){let i=`${urlRelCasamentos}?congregacao=${n}&dataInicio=01-01-2000&dataFinal=01-01-2050`;$.downloadArquivo(i,$(t))}function GerarRelNascimento(n,t){let i=`${urlRelNascimentos}?congregacao=${n}&dataInicio=01-01-2000&dataFinal=01-01-2050`;$.downloadArquivo(i,$(t))}function GerarRelObreiros(n,t){let i=`${urlRelObreiros}?congregacao=${n}`;$.downloadArquivo(i,$(t))}function bytesToSize(n){var t;return n==0?"0 Byte":(t=parseInt(Math.floor(Math.log(n)/Math.log(1024))),Math.round(n/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t])}async function AJAXSubmit(){let t=$("#Arquivo").val();if(t==null||t==""){$.bsMessageError("Atenção","Favor selecionar o arquivo para Capturar!");$("#Arquivo").focus();return}if(ValidarArquivoUpload(files)){let t={id:$("#Id").val(),nomeArquivo:files[0].name};var n=gerarOverlay(),i=gerarLoadingFrame();n.append(i);$("body").append(n);setTimeout(function(){n.focus()},0);$.ajax({cache:!1,type:"POST",url:urlArqJaExiste,contentType:"application/x-www-form-urlencoded",dataType:"json",data:t,error:function(n,t,i){console.log(i);console.log(n.responseText)},success:function(n){if(n.status=="OK"){let i=n.data;i==!0?(removerOverlay(null),$.showYesNoAlert(`O Arquivo ${t.nomeArquivo} já existe. Deseja sobrepor o arquivo?`,"Arquivo já existe",function(){SubmitFormulario()})):SubmitFormulario()}else removerOverlay(null),$.bsMessageError("Atenção",n.Message)}})}return!1}function SubmitFormulario(){var n=new FormData;n.append("files",files[0]);n.append("id",$("#Id").val());var i=function(n){if(n.lengthComputable){var t=n.loaded/n.total,t=Math.round(event.loaded*100/event.total)+"%";$(".percent-progress").html(t);$(".progress-bar").css("width",t)}},t=gerarOverlay(),r=gerarLoadingFrame();t.append(r);$("body").append(t);setTimeout(function(){t.focus()},0);$.ajax({url:urlUplArq,type:"POST",xhr:function(){var n=new window.XMLHttpRequest;return n.addEventListener("progress",i,!1),n.upload.addEventListener("progress",i,!1),n},data:n,"async":!0,error:function(n,t,i){console.log(i);console.log(n.responseText)},success:function(n){removerOverlay(null);var t=gerarOverlay(),i=gerarLoadingFrame();t.append(i);$("body").append(t);setTimeout(function(){t.focus()},0);n.status=="OK"?(arquivos=n.data,CarregarArquivos(arquivos,$("#Acao").val()=="Update"),$("#Arquivo").val(""),$(".size-file").empty(),$(".percent-progress").html("0%"),$(".progress-bar").css("width",0)):$.alertError("Upload de Arquivo",n.mensagem)},complete:function(){removerOverlay(null)},cache:!1,contentType:!1,processData:!1})}function ValidarArquivoUpload(n){let t=$("#Arquivo").val();if(t==null||t=="")return $.bsMessageError("Atenção","Favor selecionar o arquivo para Capturar!"),$("#Arquivo").focus(),!1;if(n!=null&&n!=undefined&&n.length>0&&n[0].size>tamanhoMax)return $.bsMessageError("Atenção",`Arquivo maior que ${bytesToSize(tamanhoMax)}. Tamanho do arquivo selecionado: ${bytesToSize(n[0].size)}`),$("#Arquivo").focus(),!1;var i=t.split(".").pop();return typeof extPermitidas.find(n=>i.toLowerCase()==n)=="undefined"?($.alertError("Upload de Arquivo","Somente arquivos dos Tipos Excel, Word, PDF e ZIP são permitidos para Upload."),$("#Arquivo").val(""),!1):!0}var files,indexObs=-1;let extPermitidas=["xls","xlsx","doc","docx","pdf","zip"],tamanhoMax=104857600;$(function(){var i,t,u,r,n;if($(".cnpj").mask("99.999.999/9999-99"),$("#lnkCongregacaoResponsavelId").popUp("Pesquisar Congregação Responsável","Congregacao","CongregacaoResponsavelId"),i={TipoMembro:3,Status:1},$("#lnkPastorResponsavelId").popUp("Pesquisar Pastor","Membro","PastorResponsavelId",i),$("#lnkResponsavelId").popUp("Pesquisar Membro Responsável","Membro","ResponsavelId",i),$("#lnkObreiroId").popUp("Pesquisar Obreiro","Membro","ObreiroId",i),$("#CongregacaoResponsavelId").blur(function(){var n=$(this).val(),t;n>0&&(t={CongregacaoId:n},$.ajaxPost("/Secretaria/Congregacao/BuscarCongregacao",t,function(n){$("#CongregacaoResponsavelNome").val("");n.Id==0?($.alertError("Atenção","Código inválido!"),$(this).val("")):n.Id>0&&$("#CongregacaoResponsavelNome").val(n.Nome)}))}),$("#PastorResponsavelId").change(n=>{var t,i,r;if(n.preventDefault(),t=$("#PastorResponsavelId").val(),t>0){if(obreiros.length>0&&(i=$.findElement(obreiros,"ObreiroId",$("#PastorResponsavelId").val()),i!=null&&i!=undefined)){$.alertError("Atenção","Código já incluído na Lista de Obreiros!");$("#PastorResponsavelId").val("");$("#PastorResponsavelNome").val("");return}r={membroId:t,congregacaoId:$("#Id").val()};$.ajaxPost(urlBuscarRespons,r,function(n){if(n.result=="OK"){const{membro:t}=n;$("#PastorResponsavelNome").val("");t.Id==0?($.alertError("Atenção","Código inválido!"),$("#PastorResponsavelId").val("")):t.Status!=1?($.alertError("Atenção","Membro não Ativo!"),$("#PastorResponsavelId").val("")):t.Cargos.length==0?($.alertError("Atenção","Membro não possui Cargos cadastrado!"),$("#PastorResponsavelId").val("")):$("#PastorResponsavelNome").val(t.Nome)}else $("#PastorResponsavelId").val(""),$("#PastorResponsavelNome").val(""),$.alertError("Atenção",n.mensagem)})}}),$("#ObreiroId").change(n=>{var t,i,r;if(n.preventDefault(),t=$("#ObreiroId").val(),t>0){if($("#ObreiroNome").val(""),$("#ObreiroCargo").val(""),obreiros.length>0&&(i=$.findElement(obreiros,"ObreiroId",$("#ObreiroId").val()),i!=null&&i!=undefined)){$.alertError("Atenção","Código já incluído na Lista de Obreiros!");$("#ObreiroId").val("");$("#ObreiroNome").val("");$("#ObreiroCargo").val("");return}if($("#PastorResponsavelId").val()==t){$.alertError("Atenção","Obreiro já cadastrado como Pastor Responsável da Congregação!");$("#ObreiroId").val("");$("#ObreiroNome").val("");$("#ObreiroCargo").val("");return}r={membroId:t,congregacaoId:$("#Id").val(),obreiro:!0};$.ajaxPost(urlBuscarRespons,r,function(n){if(n.result=="OK"){const{membro:t}=n;$("#ObreiroNome").val("");$("#ObreiroCargo").val("");t.Id==0?($.alertError("Atenção","Código inválido!"),$("#ObreiroId").val("")):t.Status!=1?($.alertError("Atenção","Membro não Ativo!"),$("#ObreiroId").val("")):t.Cargos.length==0?($.alertError("Atenção","Membro não possui Cargos cadastrado!"),$("#ObreiroId").val("")):($("#ObreiroNome").val(t.Nome),$("#ObreiroCargo").val(t.Cargos[0].Descricao))}else $("#ObreiroId").val(""),$("#ObreiroNome").val(""),$("#ObreiroCargo").val(""),$.alertError("Atenção",n.mensagem)})}}),$("#ResponsavelId").blur(function(){var n=$(this).val(),t;n>0&&(t={MembroId:n},$.ajaxPost("/Secretaria/Membro/BuscarMembro",t,function(n){$("#ResponsavelNome").val("");n.Id==0?($.alertError("Atenção","Código inválido!"),$(this).val("")):n.Status!=1?($.alertError("Atenção","Membro não Ativo!"),$(this).val("")):n.Id>0&&$("#ResponsavelNome").val(n.Nome)}))}),t=$("#Acao").val(),t=="Create"||t=="Read"||t=="Update"||t=="Delete"){u=$("#isreadonlygrupo").val().toLowerCase()=="true";r=$("#isreadonlyobreiro").val().toLowerCase()=="true";let t=$("#isreadonlyobs").val().toLowerCase()=="true";if(obreiros.length>0){let t=document.getElementById("tbObreiro").getElementsByTagName("tbody")[0];for($(t).empty(),n=0;n<obreiros.length;n++){let i=t.insertRow(n);i.className="jtable-data-row"+(n%2==0?" jtable-row-even":"");$.incluirCelulasTabela(i,0,null,obreiros[n].ObreiroId);$.incluirCelulasTabela(i,1,null,obreiros[n].ObreiroNome);$.incluirCelulasTabela(i,2,null,obreiros[n].ObreiroCargo);r||$.incluirCelulasTabela(i,3,null,'<input type="button" value="Excluir" class="btn btn-danger btn-sm" onclick="ExcluirRowObr(this);">')}}if(grupos.length>0){let t=document.getElementById("tbGrupo").getElementsByTagName("tbody")[0];for($(t).empty(),n=0;n<grupos.length;n++){let i=t.insertRow(n);i.className="jtable-data-row"+(n%2==0?" jtable-row-even":"");$.incluirCelulasTabela(i,0,null,grupos[n].Grupo);$.incluirCelulasTabela(i,1,null,grupos[n].NomeGrupo);$.incluirCelulasTabela(i,2,null,grupos[n].ResponsavelId);$.incluirCelulasTabela(i,3,null,grupos[n].ResponsavelNome);u||$.incluirCelulasTabela(i,4,null,'<input type="button" value="Excluir" class="btn btn-danger btn-sm" onclick="ExcluirRowGrp(this);">')}}observacoes.length>0&&MontarGridObs(observacoes)}$("#btnAddObr").click(function(){var i=CarregarObreiro($("#ObreiroId").val(),$("#ObreiroNome").val(),$("#ObreiroCargo").val()),f=$(document).find("[data-valmsg-for='ObreiroId']"),r,u,n,t;if(f.html(""),r=!1,(i.ObreiroId==null||i.ObreiroId==undefined||i.ObreiroId==0)&&(r=!0,f.html('<span id="ObreiroId-error" class="">O campo Código do Obreiro é obrigatório<\/span>')),r)return!1;for(obreiros.push(i),obreiros.sort(function(n,t){return n.ObreiroCargo<t.ObreiroCargo?-1:n.ObreiroCargo>t.ObreiroCargo?1:0}),u=document.getElementById("tbObreiro").getElementsByTagName("tbody")[0],$(u).empty(),n=0;n<obreiros.length;n++)t=u.insertRow(n),t.className="jtable-data-row"+(n%2==0?" jtable-row-even":""),$.incluirCelulasTabela(t,0,null,obreiros[n].ObreiroId),$.incluirCelulasTabela(t,1,null,obreiros[n].ObreiroNome),$.incluirCelulasTabela(t,2,null,obreiros[n].ObreiroCargo),$.incluirCelulasTabela(t,3,null,'<input type="button" value="Excluir" class="btn btn-danger btn-sm" onclick="ExcluirRowObr(this);">');$("#ObreiroId").val("");$("#ObreiroNome").val("");$("#ObreiroCargo").val("")});$("#btnAddGrupo").click(function(){var n=CarregarGrupo($("#GrupoId").val(),$("#GrupoId :selected").text(),$("#NomeGrupo").val(),$("#ResponsavelId").val(),$("#ResponsavelNome").val()),r=!1,o=$(document).find("[data-valmsg-for='GrupoId']"),u,f,e,t,i;if(o.html(""),(n.GrupoId==null||n.GrupoId==undefined||n.GrupoId==0)&&(r=!0,o.html('<span id="GrupoId-error" class="">O campo Grupo é obrigatório<\/span>')),u=$(document).find("[data-valmsg-for='NomeGrupo']"),u.html(""),(n.NomeGrupo==null||n.NomeGrupo==undefined||n.NomeGrupo=="")&&(r=!0,u.html('<span id="NomeGrupo-error" class="">O campo Nome do Grupo é obrigatório<\/span>')),f=$(document).find("[data-valmsg-for='ResponsavelId']"),f.html(""),(n.ResponsavelId==null||n.ResponsavelId==undefined||n.ResponsavelId==0||n.ResponsavelId=="")&&(r=!0,f.html('<span id="ResponsavelId-error" class="">O campo Cód. Resp. é obrigatório<\/span>')),r)return!1;for(grupos.push(n),e=document.getElementById("tbGrupo").getElementsByTagName("tbody")[0],$(e).empty(),t=0;t<grupos.length;t++)i=e.insertRow(t),i.className="jtable-data-row"+(t%2==0?" jtable-row-even":""),$.incluirCelulasTabela(i,0,null,grupos[t].Grupo),$.incluirCelulasTabela(i,1,null,grupos[t].NomeGrupo),$.incluirCelulasTabela(i,2,null,grupos[t].ResponsavelId),$.incluirCelulasTabela(i,3,null,grupos[t].ResponsavelNome),$.incluirCelulasTabela(i,4,null,'<input type="button" value="Excluir" class="btn btn-danger btn-sm" onclick="ExcluirRowGrp(this);">');$("#GrupoId").val("");$("#NomeGrupo").val("");$("#ResponsavelId").val("");$("#ResponsavelNome").val("")});$("#btnAddObs").click(function(n){n.preventDefault();var t=CarregarObs($("#Observacao").val(),null,$("#idUsuarioObs").val(),$("#nomeUsuarioObs").val()),i=!1,u=$(document).find("[data-valmsg-for='Observacao']");if(u.html(""),(t.Observacao==null||t.Observacao==undefined||t.Observacao==0)&&(i=!0,u.html('<span id="Observacao-error" class="">O campo Observação é de preenchimento obrigatório<\/span>')),i)return!1;indexObs>-1&&(observacoes.splice(indexObs,1),indexObs=-1);observacoes.push(t);MontarGridObs(observacoes);$("#btnAddObs").html('<span class="glyphicon glyphicon-plus"><\/span> Adicionar \n');$("#btnAddObs").removeClass("btn-info");$("#btnAddObs").addClass("btn-primary");$("#Observacao").val("");r||HabilitarBotoesTabela($(document.getElementById("tbObs").getElementsByTagName("tbody")),!1)});$(document).on("click","#btnCancObs",{},function(n){n.preventDefault();$("#Observacao").val("");indexObs=-1;$("#btnAddObs").html('<span class="glyphicon glyphicon-plus"><\/span> Adicionar \n');$("#btnAddObs").removeClass("btn-info");$("#btnAddObs").addClass("btn-primary");HabilitarBotoesTabela($(document.getElementById("tbObs").getElementsByTagName("tbody")),!1)});$("#btnBuscarCEP").click(function(){PesquisarCEP($("#Endereco_Cep"),$("#Endereco_Logradouro"),$("#Endereco_Bairro"),$("#Endereco_Cidade"),$("#Endereco_Estado"))});$(document).on("click","#btnSalvar",{},function(n){n.preventDefault();var t="Deseja realmente criar uma nova Congregação?";$("#Acao").val()=="Update"&&(t="Deseja realmente atualizar a Congregação?");$.showYesNoAlert(t,"Congregação",function(){var t=$("#frmCongrecacao"),n;t.validate();t.valid()?($("#Grp").val(JSON.stringify(grupos)),$("#Obr").val(JSON.stringify(obreiros)),$("#Obs").val(JSON.stringify(observacoes)),t.submit()):(n=ValidarFormulario(),n!=null&&n!=undefined&&n!=""&&$.alertError("Membro",n))})});$(document).on("click","#lnkExcluir",{},function(n){n.preventDefault();var t={id:$(this).data("congregregaoid")};$.ajaxPost(urlQtdMemb,t,function(n){var r,i;if(n.findIndex(n=>n.Quantidade>0)>=0)for(r=$("#modalExcluir table")[0].getElementsByTagName("tbody")[0],$(r).empty(),$("#modalExcluir").modal({backdrop:"static"}),i=0;i<n.length;i++)n[i].Quantidade>0&&AddRowGridModal(i,n[i].TipoDescr,n[i].Quantidade,$("#lnkExcluir").data("congregregaoid"));else $.showYesNoAlert('<h3 style="color:red">Você tem certeza que deseja excluir esta Congregação?<\/br>Após a confirmação NÃO será mais possível recuperar os dados.<\/h3>',"Congregação",function(){$.ajaxPost(urlExcluir,t,function(n){n.status=="OK"?window.location=n.url:$.alertError("Membro",n.mensagem)})})})});$("#lnkBuscarCongregacao").popUp("","Congregacao","CongregacaoNovaId");$("#CongregacaoNovaId").change(function(){var r=$(document).find("[data-valmsg-for='CongregacaoNovaId']"),t,n,i;if(r.html(""),t=$(this).data("congregorig"),n=$("#CongregacaoNovaId").val(),n==t)return $.bsMessageError("Atenção","Congregação Destino deve ser diferente da Congregação Origem"),$("#CongregacaoNovaId").val(""),$("#CongregacaoNome").val(""),!1;n>0&&(i={CongregacaoId:n},$.ajaxPost("/Secretaria/Congregacao/BuscarCongregacaoSemFiltroUsuario",i,function(n){$("#CongregacaoNome").val("");n.Id==0?($.bsMessageError("Atenção","Código de Congregação inválido!"),$("#CongregacaoNovaId").val(""),$("#CongregacaoNome").val("")):n.Id>0&&$("#CongregacaoNome").val(n.Nome)}))});$(document).on("click","#btnExcluirModal",{},function(n){n.preventDefault();let i=$(this).data("congregid"),r=$(this).data("congregnome");var u=$("#CongregacaoNovaId").val(),t=$("#CongregacaoNome").val();if(t==undefined||t==null||t=="")return $.bsMessageError("Atenção","Congregação Destino é de preenchimento obrigatório!"),$("#CongregacaoNovaId").val(""),$("#CongregacaoNome").val(""),!1;if(u==i)return $.bsMessageError("Atenção","Congregação Destino deve ser diferente da Congregação Origem"),$("#CongregacaoNovaId").val(""),$("#CongregacaoNome").val(""),!1;let f={id:i,congregacaoId:u};$.showYesNoAlert(`<h3 style="color:red">IMPORTANTE:<br/><br/>Todas os dados (Eventos, Obreiros, Arquivos, etc) referentes a Congregação '${r}' serão excluídos e os Nascimentos, Casamentos, Cursos, Usuários e Membros vinculados a ela serão transferidos para a Congregação '${$("#CongregacaoNome").val()}'.<br/><br/>Você tem certeza que deseja a excluir congregação '${r}'? <br/> Após a confirmação NÃO será mais possível recuperar os dados.</h3>'`,"Congregação",function(){$.ajaxPost(urlExcluir,f,function(n){n.status=="OK"?window.location=n.url:$.alertError("Membro",n.mensagem)});$.alertError("Membro","Excluido")})});$("#Acao").val()!="Create"&&CarregarArquivos(arquivos,$("#Acao").val()=="Update");$('input[name="Arquivo"]').change(function(n){if(ValidarArquivoUpload(n.target.files)){files=n.target.files;var t=$('input[name="Arquivo"]')[0].files[0];$(".size-file").html(` ${bytesToSize(t.size)}`)}else $("#Arquivo").val(""),$(".size-file").empty(),files=null});$("#btnCancelar").click(()=>{$("#Arquivo").val(""),$(".size-file").empty(),files=null})});
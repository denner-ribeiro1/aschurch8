var listaMembro=[],files;$(()=>{$("#Arquivo").change(n=>{n.preventDefault;var t=$("#Arquivo").val().split(".").pop();typeof["xls","xlsx"].find(n=>t.toLowerCase()==n)=="undefined"?($.alertError("Upload de Arquivo","Somente arquivos do Tipo Excel são permitidos para Upload."),$("#Arquivo").val("")):files=n.target.files}),$("#btnCapturar").click(()=>{var r,u,t,f,i;let n=$("#Arquivo").val();if(n==null||n==""){$.bsMessageError("Atenção","Favor selecionar o arquivo para Capturar!");$("#Arquivo").focus();return}r=["xls","xlsx"];u=n.split(".").pop();typeof r.find(n=>u.toLowerCase()==n)=="undefined"?($.alertError("Upload de Arquivo","Somente arquivos do Tipo Excel são permitidos para Upload."),$("#Arquivo").val("")):(t=gerarOverlay(),f=gerarLoadingFrame(),t.append(f),$("body").append(t),setTimeout(function(){t.focus()},0),i=new FormData,i.append("files",files[0]),i.append("id",$("#Presenca").val()),$.ajax({type:"POST",url:urlCarregarArquivo,contentType:!1,processData:!1,data:i,success:function(t){if(t.status=="OK"){listaMembro=t.data;let i=`${urlPopUp}?id=${$("#Presenca").val()}&arquivo=${n}`;$.popUpUrl(i,600,800)}else $.alertError("Captura de Arquivo",t.mensagem)},complete:function(){removerOverlay(null)}}))}),$("#btnCancelar").click(()=>{$("#Arquivo").val(""),files=null})});
var lista=window.parent.listaMembro,table,colunas=[{width:"13%",title:"Tipo",mRender:function(n,t,i){return i.MembroId==0?"Não Membro":"Membro"}},{width:"25%",data:"Nome",title:"Nome"},{width:"15%",data:"CPF",title:"CPF"},{width:"20%",data:"Igreja",title:"Congregação/Igreja"},{width:"12%",data:"Cargo",title:"Cargo"},{width:"15%",title:"Críticas",mRender:function(n,t,i){let u="";for(var r=0;r<i.ErrosRetorno.length;r++)u+=i.ErrosRetorno[r].Mensagem+"<br />";return u}},];$(()=>{"use strict";let t=$("#lblNomeArquivo").text().split("\\").pop();$("#lblNomeArquivo").text(t);let n=!1;n=lista.map(n=>n.ErrosRetorno.map(n=>n.Mensagem)).filter(n=>n!="").length>0;n?($("#btnConfirmar").hide(),$("#checkTodos").hide(),$("#tbMembro tbody tr").find("input:checkbox").each(function(){$(this).attr("disabled","disabled")}),$("#lblStatus").text("Foram encontradas algumas inconsistências na Captura do arquivo. Ajustar conforme a lista abaixo.")):$("#lblStatus").text("Arquivo válido para captura.");let i=lista;table!=undefined&&table!=null&&table.destroy();table=$("#grdMembros").DataTable({search:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"Tudo"],],language:{url:"/lib/plugins/datatables/pt_br.json"},aaData:i,columns:colunas});$("#btnConfirmar").click(()=>{$.showYesNoAlert("Deseja efetivar a capturar do Arquivo?","Captura de Arquivo",function(){var t=gerarOverlay(),i=gerarLoadingFrame(),n;t.append(i);$("body").append(t);setTimeout(function(){t.focus()},0);n=new FormData;n.append("files",parent.files[0]);n.append("idPresenca",$("#IdPresenca").val());$.ajax({type:"POST",url:urlIncluir,contentType:!1,processData:!1,data:n,success:function(n){n.status=="OK"?Swal.fire("Inscrições",n.msg,"info").then(()=>{$("#Arquivo",parent.document).val(""),parent.ListarMembros($("#Presenca",parent.document).val(),$("#chkNaoMembro",parent.document).prop("checked")),parent.$.fancybox.close()}):$.alertError("Inscrição",n.msg)},complete:function(){removerOverlay(null)}})})});$("#btnCancelar").click(n=>{n.preventDefault,$("#Arquivo",parent.document).val(""),parent.$.fancybox.close()})});
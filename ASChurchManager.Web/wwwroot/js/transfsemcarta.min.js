function AddNewLine(n,t,i,r){var h=$("#tbMembro tbody")[0],u,f,e,o,c,s;h!=null&&(membros.length==0&&$("#tbMembro tbody tr").remove(),u=h.insertRow(-1),u.className="jtable-data-row"+(r%2==0?" jtable-row-even":""),f=u.insertCell(0),f.width="10%",f.innerHTML=n,e=u.insertCell(1),e.width="35%",e.innerHTML=t,o=u.insertCell(2),o.width="30%",o.innerHTML=i,c='<button type="button" class="btn btn-danger btn-sm" id="btnExcluir" onclick = "ExcluirMembro('+n+')"; return false;>     <span class="glyphicon glyphicon-list-alt"><\/span> Excluir<\/button>',s=u.insertCell(3),s.width="10%",s.innerHTML=c)}function ExcluirMembro(n){$.showYesNoAlert("Deseja excluir o Membro?","Transfência sem carta",function(){for(var t=0;t<membros.length;t++)membros[t].MembroId==n&&membros.splice(t,1);if($("#tbMembro tbody tr").remove(),membros.length===0){var r=$("#tbMembro tbody")[0],u=r.insertRow(-1),i=u.insertCell(0);i.colSpan=4;i.width="100%";i.innerHTML="Não existem Membros selecionados para a Transferência"}else for(t=0;t<membros.length;t++)AddNewLine(membros[t].MembroId,membros[t].Nome,membros[t].CongregacaoOrigem,t)})}var membros=[];$(function(){"use strict";$("#linkIdMembro").popUp("","Membro","MembroId",{TipoMembro:3,Status:1});$("#MembroId").blur(function(){var n=parseInt($("#MembroId").val()),t;n>0&&(t={MembroId:n},$.ajaxPost(urlBuscarMembro,t,function(n){n.status==="ERRO"?($.bsMessageError("Atenção",n.msg),$("#MembroId").val(""),$("#Nome").val(""),$("#CongregacaoOrigemId").val(""),$("#CongregacaoOrigem").val("")):($("#Nome").val(n.membro.Nome),$("#CongregacaoOrigemId").val(n.membro.Congregacao.Id),$("#CongregacaoOrigem").val(n.membro.Congregacao.Nome))}))});$("#lnkBuscarCongregacao").popUp("","Congregacao","CongregacaoDestId");$("#CongregacaoDestId").blur(function(){var i=$(document).find("[data-valmsg-for='CongregacaoDestId']"),n,t;i.html("");n=$(this).val();n>0&&(t={CongregacaoId:n},$.ajaxPost("/Secretaria/Congregacao/BuscarCongregacaoSemFiltroUsuario",t,function(n){$("#CongregacaoDest").val("");n.Id==0?($.bsMessageError("Atenção","Código de Congregação inválido!"),$(this).val("")):n.Id>0&&$("#CongregacaoDest").val(n.Nome)}))});$(document).on("click","#btnAdicionar",{},function(n){var t,i,r;if(n.preventDefault(),t={MembroId:$("#MembroId").val(),Nome:$("#Nome").val(),CongregacaoOrigem:$("#CongregacaoOrigem").val()},i=$(document).find("[data-valmsg-for='MembroId']"),i.html(""),r=!1,(t.MembroId==null||t.MembroId==undefined||t.MembroId==0)&&(r=!0,i.html('<span id="MembroId-error" class="">O campo Id do Membro é obrigatório<\/span>')),membros.find(n=>n.MembroId===t.MembroId)!=null)return $.alertError("Transfência sem Carta","Membro já adicionado!"),$("#MembroId").val(""),$("#Nome").val(""),$("#CongregacaoOrigemId").val(""),$("#CongregacaoOrigem").val(""),!1;if(r)return!1;$("#Nome").val()!=null&&$("#Nome").val()!=""&&$("#Nome").val()!=undefined&&(AddNewLine(t.MembroId,t.Nome,t.CongregacaoOrigem,membros.length),membros.push(t),$("#MembroId").val(""),$("#Nome").val(""),$("#CongregacaoOrigemId").val(""),$("#CongregacaoOrigem").val(""))});$("#btnTransferir").click(function(n){var i,t,r;if(n.preventDefault(),i=$(document).find("[data-valmsg-for='CongregacaoDestId']"),i.html(""),t={congregacaoDestinoId:$("#CongregacaoDestId").val()},r=!1,(t.congregacaoDestinoId==null||t.congregacaoDestinoId==undefined||t.congregacaoDestinoId==0)&&(r=!0,i.html('<span id="CongregacaoDestId-error" class="">O campo Congregação Destino é obrigatório<\/span>')),membros.length===0)return $.alertError("Transfência sem Carta","Não há membros adicionados para Transferência."),!1;if(r)return!1;$.showYesNoAlert("Deseja realmente transferir os membros acima?","Transferência sem carta",function(){$("#MembrosJSON").val(JSON.stringify(membros));var n=$("#frmTransfCarta"),t=n.attr("action");n.valid()&&$.ajaxPostForm(t,$("#frmTransfCarta"),function(n){n.status==="OK"?window.location=n.url:$.alertError("Configuração de Batismo",n.msg)})})})});
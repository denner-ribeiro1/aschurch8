function excluirCasamento(){var n={id:$("#lnkExcluir").data("casamentoid")};$.showYesNoAlert('<h3 style="color:red">Você tem certeza que deseja excluir este Casamento?<\/br>Após a confirmação NÃO será mais possível recuperar o Casamento.<\/h3>',"Casamento",function(){$.ajaxPost(urlExcluir,n,function(n){n.status==="OK"?window.location=n.url:$.alertError("Casamento",n.mensagem)})})}function buscarMembro(n,t){if(n>0){var i={MembroId:n};t="#"+t;$.ajaxPost("/Secretaria/Membro/BuscarMembro",i,function(n){$(t).val("");n.Id==0?($.bsMessageError("Atenção","Membro não cadastrado!"),$(this).val("")):n.Id>0&&$(t).val(n.Nome)})}}function HabilitaDesabilitaCampos(n,t,i,r){n?($("#"+t).show(),$("label[for="+i+"]").hide(),$("#"+i).removeAttr("readonly"),$("#"+i).addClass("alinhar"),$("#"+i).focus(),$("#"+r).attr("readonly","readonly")):($("#"+t).hide(),$("label[for="+i+"]").show(),$("#"+i).attr("readonly","readonly"),$("#"+i).removeClass("alinhar"),$("#"+r).removeAttr("readonly"),$("#"+r).focus())}$(function(){"use strict";var t,n;$("#HoraInicio").mask("99:99");$("#HoraFim").mask("99:99");actionName==="Details"?(HabilitaDesabilitaCampos(!1,"lnkPastorId","PastorId","PastorNome"),HabilitaDesabilitaCampos(!1,"lnkNoivoId","NoivoId","NoivoNome"),HabilitaDesabilitaCampos(!1,"lnkPaiNoivoId","PaiNoivoId","PaiNoivoNome"),HabilitaDesabilitaCampos(!1,"lnkMaeNoivoId","MaeNoivoId","MaeNoivoNome"),HabilitaDesabilitaCampos(!1,"lnkNoivaId","NoivaId","NoivaNome"),HabilitaDesabilitaCampos(!1,"lnkPaiNoivaId","PaiNoivaId","PaiNoivaNome"),HabilitaDesabilitaCampos(!1,"lnkMaeNoivaId","MaeNoivaId","MaeNoivaNome")):(t=$("#hdnUsuarioSede").val().toLowerCase()==="true",$("#lnkBuscarCongregacao").removeAttr("class"),t===!1?($("#CongregacaoId").attr("readonly","readonly"),$("#lnkBuscarCongregacao").attr("class","readonly")):$("#lnkBuscarCongregacao").popUp("","Congregacao","CongregacaoId"),$("#PastorId").removeAttr("readonly"),$("#PastorNome").removeAttr("readonly"),$("label[for=PastorId]").hide(),$("#PastorId").addClass("alinhar"),$("#lnkPastorId").show(),$("#PastorMembro").prop("checked")&&($("#PastorId").attr("readonly","readonly"),$("#PastorNome").attr("readonly","readonly"),$("label[for=PastorId]").show(),$("#PastorId").removeClass("alinhar"),$("#lnkPastorId").hide()),HabilitaDesabilitaCampos($("#NoivoMembro").prop("checked"),"lnkNoivoId","NoivoId","NoivoNome"),HabilitaDesabilitaCampos($("#PaiNoivoMembro").prop("checked"),"lnkPaiNoivoId","PaiNoivoId","PaiNoivoNome"),HabilitaDesabilitaCampos($("#MaeNoivoMembro").prop("checked"),"lnkMaeNoivoId","MaeNoivoId","MaeNoivoNome"),HabilitaDesabilitaCampos($("#NoivaMembro").prop("checked"),"lnkNoivaId","NoivaId","NoivaNome"),HabilitaDesabilitaCampos($("#PaiNoivaMembro").prop("checked"),"lnkPaiNoivaId","PaiNoivaId","PaiNoivaNome"),HabilitaDesabilitaCampos($("#MaeNoivaMembro").prop("checked"),"lnkMaeNoivaId","MaeNoivaId","MaeNoivaNome"),$("#CongregacaoId").change(function(){var n=$(this).val(),t;n>0&&(t={CongregacaoId:n},$.ajaxPost("/Secretaria/Congregacao/BuscarCongregacao",t,function(n){$("#CongregacaoNome").val("");n.Id==0?($.bsMessageError("Atenção","Código inválido!"),$(this).val("")):n.Id>0&&($("#CongregacaoNome").val(n.Nome),$("#PastorId").val(n.PastorResponsavelId),$("#PastorNome").val(n.PastorResponsavelNome),$("#PastorId").attr("readonly","readonly"),$("#PastorNome").attr("readonly","readonly"))}))}),$("#HoraFim").change(function(){var h=$("#CasamentoId").val(),c=$("#CongregacaoNome").val(),u=$("#CongregacaoId").val(),n=$("#DataCasamento").val(),t=$("#HoraInicio").val(),i=$(this).val(),r,s;if(u==undefined||u==0){$.bsMessageError("Atenção","Congregação é de preenchimento obrigatório.");return}if(n==undefined||n==""){$.bsMessageError("Atenção","Data de Casamento é de preenchimento obrigatório.");return}if(t==undefined||t==""){$.bsMessageError("Atenção","Hora do Início do Casamento é de preenchimento obrigatório.");return}if(i==undefined||i==""){$.bsMessageError("Atenção","Hora do Término do Casamento é de preenchimento obrigatório.");return}var f=n.split("/"),o=f[1]+"/"+f[0]+"/"+f[2],e=new Date(o+" "+t);e=e.getTime();r=new Date(o+" "+i);r=r.getTime();e>r&&$.bsMessageError("Atenção","Hora do Início é maior que a Hora Final do Casamento.");s={CongregacaoId:u,CongregacaoNome:c,DataCasamento:n,HoraInicio:t,HoraFim:i,CasamentoId:h};$.ajaxPost("/Secretaria/Casamento/VerificarCasamento",s,function(n){n.status=="OK"?n.dados.CasamentoId>0&&($.bsMessageError("Atenção","Casamento já agendado para esta data!"),$("#DataCasamento").val(""),$("#HoraInicio").val(""),$("#HoraFim").val("")):n.status=="ERRO"&&($.bsMessageError(n.mensagem),$("#DataCasamento").val(""),$("#HoraInicio").val(""),$("#HoraFim").val(""))})}),n={TipoMembro:3,Status:1},$("#lnkPastorId").popUp("Pesquisar Pastor","Membro","PastorId",n),$("#PastorId").change(function(){if(!$("#PastorId").is("[readonly]")){var n=$(this).val();(n!==""||n===null||n===undefined)&&(buscarMembro(n,"PastorNome"),($("#PastorNome").val()!==""||$("#PastorNome").val()!==null||$("#PastorNome").val()!==undefined)&&$("#PastorId").attr("readonly","readonly"))}}),$("#PastorNome").change(function(){($(this).val()===""||$(this).val()===null||$(this).val()===undefined)&&$("#PastorId").removeAttr("readonly")}),$("#PastorMembro").change(function(){var n,t;$("#PastorMembro").prop("checked")===!1?($("#PastorId").removeAttr("readonly"),$("#PastorNome").removeAttr("readonly"),$("label[for=PastorId]").hide(),$("#lnkPastorId").show(),$("#PastorId").addClass("alinhar"),$("#PastorId").val(""),$("#PastorNome").val("")):($("#PastorId").attr("readonly","readonly"),$("#PastorNome").attr("readonly","readonly"),$("label[for=PastorId]").show(),$("#PastorId").removeClass("alinhar"),$("#lnkPastorId").hide(),n=$("#CongregacaoId").val(),n>0&&(t={CongregacaoId:n},$.ajaxPost("/Secretaria/Congregacao/BuscarCongregacao",t,function(n){$("#CongregacaoNome").val("");n.Id===0?($.bsMessageError("Atenção","Código inválido!"),$(this).val("")):n.Id>0&&($("#CongregacaoNome").val(n.Nome),$("#PastorId").val(n.PastorResponsavelId),$("#PastorNome").val(n.PastorResponsavelNome),$("#PastorId").attr("readonly","readonly"),$("#PastorNome").attr("readonly","readonly"))})))}),$("#lnkNoivoId").popUp("Pesquisar - Noivo","Membro","NoivoId",n),$("#NoivoId").change(function(){var n=$(this).val();buscarMembro(n,"NoivoNome")}),$("#NoivoMembro").change(function(){HabilitaDesabilitaCampos($("#NoivoMembro").prop("checked"),"lnkNoivoId","NoivoId","NoivoNome");$("#NoivoMembro").prop("checked")?$("#NoivoNome").val(""):$("#NoivoId").val("")}),$("#lnkPaiNoivoId").popUp("Pesquisar Pai do Noivo","Membro","PaiNoivoId",n),$("#PaiNoivoId").change(function(){var n=$(this).val();buscarMembro(n,"PaiNoivoNome")}),$("#PaiNoivoMembro").change(function(){HabilitaDesabilitaCampos($("#PaiNoivoMembro").prop("checked"),"lnkPaiNoivoId","PaiNoivoId","PaiNoivoNome");$("#PaiNoivoMembro").prop("checked")?$("#PaiNoivoNome").val(""):$("#PaiNoivoId").val("")}),$("#lnkMaeNoivoId").popUp("Pesquisar Mãe do Noivo","Membro","MaeNoivoId",n),$("#MaeNoivoId").change(function(){var n=$(this).val();buscarMembro(n,"MaeNoivoNome")}),$("#MaeNoivoMembro").change(function(){HabilitaDesabilitaCampos($("#MaeNoivoMembro").prop("checked"),"lnkMaeNoivoId","MaeNoivoId","MaeNoivoNome");$("#MaeNoivoMembro").prop("checked")?$("#MaeNoivoNome").val(""):$("#MaeNoivoId").val("")}),$("#lnkNoivaId").popUp("Pesquisar Noiva","Membro","NoivaId",n),$("#NoivaId").change(function(){var n=$(this).val();buscarMembro(n,"NoivaNome")}),$("#NoivaMembro").change(function(){HabilitaDesabilitaCampos($("#NoivaMembro").prop("checked"),"lnkNoivaId","NoivaId","NoivaNome");$("#NoivaMembro").prop("checked")?$("#NoivaNome").val(""):$("#NoivaId").val("")}),$("#lnkPaiNoivaId").popUp("Pesquisar Pai da Noiva","Membro","PaiNoivaId",n),$("#PaiNoivaId").change(function(){var n=$(this).val();buscarMembro(n,"PaiNoivaNome")}),$("#PaiNoivaMembro").change(function(){HabilitaDesabilitaCampos($("#PaiNoivaMembro").prop("checked"),"lnkPaiNoivaId","PaiNoivaId","PaiNoivaNome");$("#PaiNoivaMembro").prop("checked")?$("#PaiNoivaNome").val(""):$("#PaiNoivaId").val("")}),$("#lnkMaeNoivaId").popUp("Pesquisar Mãe da Noiva","Membro","MaeNoivaId",n),$("#MaeNoivaId").change(function(){var n=$(this).val();buscarMembro(n,"MaeNoivaNome")}),$("#MaeNoivaMembro").change(function(){HabilitaDesabilitaCampos($("#MaeNoivaMembro").prop("checked"),"lnkMaeNoivaId","MaeNoivaId","MaeNoivaNome");$("#MaeNoivaMembro").prop("checked")?$("#MaeNoivaNome").val(""):$("#MaeNoivaId").val("")}),$("#btnSalvar").click(function(n){n.preventDefault;var t="Deseja realmente criar um novo Casamento?";actionName==="Edit"&&(t="Deseja realmente atualizar o Casamento?");$.showYesNoAlert(t,"Casamento",function(){var n=$("#frmCasamento"),t=n.attr("action");n.valid()&&$.ajaxPostForm(t,$("#frmCasamento"),function(n){n.status==="OK"?window.location=n.url:$.alertError("Batismo",n.msg)})})}))});